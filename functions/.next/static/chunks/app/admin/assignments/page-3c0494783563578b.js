try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="151827c8-3ce0-4697-8b96-d9eadb33eabd",e._sentryDebugIdIdentifier="sentry-dbid-151827c8-3ce0-4697-8b96-d9eadb33eabd")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[312],{63406:function(e,s,r){Promise.resolve().then(r.bind(r,87351))},30401:function(e,s,r){"use strict";r.d(s,{Z:function(){return t}});let t=(0,r(79205).Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},51817:function(e,s,r){"use strict";r.d(s,{Z:function(){return t}});let t=(0,r(79205).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},87351:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return ed}});var t=r(57437),a=r(2265),i=r(37806),l=r(49322),n=r(73247),o=r(92735),d=r(70933),c=r(61094),h=r(83774),m=r(31047),u=r(32489),x=r(56096),v=r(12381),g=r(40279),f=r(79820),p=r(69174),j=r(95937),b=r(53002),y=r(9109),N=r(74291),w=r(98575),S=r(73966),A=r(6741),P=r(80886),k=r(61188),E=r(71599),C=r(66840),z="Checkbox",[I,U]=(0,S.b)(z),[R,Z]=I(z);function L(e){let{__scopeCheckbox:s,checked:r,children:i,defaultChecked:l,disabled:n,form:o,name:d,onCheckedChange:c,required:h,value:m="on",internal_do_not_use_render:u}=e,[x,v]=(0,P.T)({prop:r,defaultProp:null!=l&&l,onChange:c,caller:z}),[g,f]=a.useState(null),[p,j]=a.useState(null),b=a.useRef(!1),y=!g||!!o||!!g.closest("form"),N={checked:x,disabled:n,setChecked:v,control:g,setControl:f,name:d,form:o,value:m,hasConsumerStoppedPropagationRef:b,required:h,defaultChecked:!J(l)&&l,isFormControl:y,bubbleInput:p,setBubbleInput:j};return(0,t.jsx)(R,{scope:s,...N,children:"function"==typeof u?u(N):i})}var O="CheckboxTrigger",T=a.forwardRef((e,s)=>{let{__scopeCheckbox:r,onKeyDown:i,onClick:l,...n}=e,{control:o,value:d,disabled:c,checked:h,required:m,setControl:u,setChecked:x,hasConsumerStoppedPropagationRef:v,isFormControl:g,bubbleInput:f}=Z(O,r),p=(0,w.e)(s,u),j=a.useRef(h);return a.useEffect(()=>{let e=null==o?void 0:o.form;if(e){let s=()=>x(j.current);return e.addEventListener("reset",s),()=>e.removeEventListener("reset",s)}},[o,x]),(0,t.jsx)(C.WV.button,{type:"button",role:"checkbox","aria-checked":J(h)?"mixed":h,"aria-required":m,"data-state":K(h),"data-disabled":c?"":void 0,disabled:c,value:d,...n,ref:p,onKeyDown:(0,A.Mj)(i,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,A.Mj)(l,e=>{x(e=>!!J(e)||!e),f&&g&&(v.current=e.isPropagationStopped(),v.current||e.stopPropagation())})})});T.displayName=O;var D=a.forwardRef((e,s)=>{let{__scopeCheckbox:r,name:a,checked:i,defaultChecked:l,required:n,disabled:o,value:d,onCheckedChange:c,form:h,...m}=e;return(0,t.jsx)(L,{__scopeCheckbox:r,checked:i,defaultChecked:l,disabled:o,required:n,onCheckedChange:c,name:a,form:h,value:d,internal_do_not_use_render:e=>{let{isFormControl:a}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T,{...m,ref:s,__scopeCheckbox:r}),a&&(0,t.jsx)(M,{__scopeCheckbox:r})]})}})});D.displayName=z;var _="CheckboxIndicator",W=a.forwardRef((e,s)=>{let{__scopeCheckbox:r,forceMount:a,...i}=e,l=Z(_,r);return(0,t.jsx)(E.z,{present:a||J(l.checked)||!0===l.checked,children:(0,t.jsx)(C.WV.span,{"data-state":K(l.checked),"data-disabled":l.disabled?"":void 0,...i,ref:s,style:{pointerEvents:"none",...e.style}})})});W.displayName=_;var F="CheckboxBubbleInput",M=a.forwardRef((e,s)=>{let{__scopeCheckbox:r,...i}=e,{control:l,hasConsumerStoppedPropagationRef:n,checked:o,defaultChecked:d,required:c,disabled:h,name:m,value:u,form:x,bubbleInput:v,setBubbleInput:g}=Z(F,r),f=(0,w.e)(s,g),p=function(e){let s=a.useRef({value:e,previous:e});return a.useMemo(()=>(s.current.value!==e&&(s.current.previous=s.current.value,s.current.value=e),s.current.previous),[e])}(o),j=function(e){let[s,r]=a.useState(void 0);return(0,k.b)(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let s=new ResizeObserver(s=>{let t,a;if(!Array.isArray(s)||!s.length)return;let i=s[0];if("borderBoxSize"in i){let e=i.borderBoxSize,s=Array.isArray(e)?e[0]:e;t=s.inlineSize,a=s.blockSize}else t=e.offsetWidth,a=e.offsetHeight;r({width:t,height:a})});return s.observe(e,{box:"border-box"}),()=>s.unobserve(e)}r(void 0)},[e]),s}(l);a.useEffect(()=>{if(!v)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,s=!n.current;if(p!==o&&e){let r=new Event("click",{bubbles:s});v.indeterminate=J(o),e.call(v,!J(o)&&o),v.dispatchEvent(r)}},[v,p,o,n]);let b=a.useRef(!J(o)&&o);return(0,t.jsx)(C.WV.input,{type:"checkbox","aria-hidden":!0,defaultChecked:null!=d?d:b.current,required:c,disabled:h,name:m,value:u,form:x,...i,tabIndex:-1,ref:f,style:{...i.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function J(e){return"indeterminate"===e}function K(e){return J(e)?"indeterminate":e?"checked":"unchecked"}M.displayName=F;var B=r(30401),X=r(93448);let V=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)(D,{ref:s,className:(0,X.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...a,children:(0,t.jsx)(W,{className:(0,X.cn)("flex items-center justify-center text-current"),children:(0,t.jsx)(B.Z,{className:"h-4 w-4"})})})});V.displayName=D.displayName;var q=r(89345),H=r(54761),Q=r(15804),Y=r(5978),$=r(50237),G=r(73634);let ee=async()=>{try{let e=(0,Y.IO)((0,Y.hJ)($.db,G.Ul.LOCATIONS),(0,Y.Xo)("name")),s=await (0,Y.PL)(e),r=(0,Y.IO)((0,Y.hJ)($.db,G.Ul.USERS),(0,Y.ar)("role","==","provider")),t=(await (0,Y.PL)(r)).docs.map(e=>({id:e.id,...e.data()})),a=[];for(let e of s.docs){let s=e.data(),r=e.id,i=t.filter(e=>{var s;return null===(s=e.assignedSchools)||void 0===s?void 0:s.includes(r)}).map(e=>({userId:e.id,userEmail:e.email||"",displayName:e.displayName||"Unknown",assignedAt:e.createdAt||Y.EK.now(),isActive:e.isActive}));a.push({schoolId:r,schoolName:s.name||"Unknown School",schoolAddress:s.address||"",assignedProviders:i,isActive:!1!==s.isActive,totalProviders:i.length,lastUpdated:s.updatedAt||s.createdAt||Y.EK.now()})}return a}catch(e){throw console.error("Error getting school assignments:",e),Error("Failed to fetch school assignments")}},es=async(e,s)=>{try{let r=(0,Y.JU)($.db,G.Ul.USERS,e),t=await (0,Y.QT)(r);if(!t.exists())throw Error("Provider not found");let a=t.data().assignedSchools||[];if(!a.includes(s)){let e=[...a,s];await (0,Y.r7)(r,{assignedSchools:e,updatedAt:Y.EK.now()})}}catch(e){throw console.error("Error assigning provider to school:",e),Error("Failed to assign provider to school")}},er=async(e,s)=>{try{let r=(0,Y.JU)($.db,G.Ul.USERS,e),t=await (0,Y.QT)(r);if(!t.exists())throw Error("Provider not found");let a=(t.data().assignedSchools||[]).filter(e=>e!==s);await (0,Y.r7)(r,{assignedSchools:a,updatedAt:Y.EK.now()})}catch(e){throw console.error("Error removing provider from school:",e),Error("Failed to remove provider from school")}},et=async(e,s)=>{try{let r=(0,Y.IO)((0,Y.hJ)($.db,G.Ul.USERS),(0,Y.ar)("role","==","provider")),t=await (0,Y.PL)(r),a=(0,Y.qs)($.db),i=Y.EK.now();for(let r of t.docs){let t=r.id,l=(r.data().assignedSchools||[]).filter(s=>s!==e);s.includes(t)&&l.push(e),a.update((0,Y.JU)($.db,G.Ul.USERS,t),{assignedSchools:l,updatedAt:i})}await a.commit()}catch(e){throw console.error("Error replacing school assignments:",e),Error("Failed to replace school assignments")}},ea=async()=>{try{let e=await ee(),s=e.filter(e=>e.totalProviders>0).length,r=e.reduce((e,s)=>e+s.totalProviders,0),t=new Set;return e.forEach(e=>{e.assignedProviders.forEach(e=>{e.isActive&&t.add(e.userId)})}),{totalSchools:e.length,schoolsWithProviders:s,schoolsWithoutProviders:e.length-s,totalAssignments:r,activeProviders:t.size}}catch(e){throw console.error("Error getting assignment stats:",e),Error("Failed to fetch assignment statistics")}},ei=async()=>{try{let e=(0,Y.IO)((0,Y.hJ)($.db,G.Ul.USERS),(0,Y.ar)("role","==","provider"),(0,Y.ar)("isActive","==",!0));return(await (0,Y.PL)(e)).docs.map(e=>({id:e.id,...e.data()})).filter(e=>!e.assignedSchools||0===e.assignedSchools.length)}catch(e){throw console.error("Error getting unassigned providers:",e),Error("Failed to fetch unassigned providers")}},el=async()=>{try{let e=(0,Y.IO)((0,Y.hJ)($.db,G.Ul.USERS),(0,Y.ar)("role","==","provider"),(0,Y.ar)("isActive","==",!0),(0,Y.Xo)("displayName"));return(await (0,Y.PL)(e)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw console.error("Error getting available providers:",e),Error("Failed to fetch available providers")}};function en(e){let{isOpen:s,onClose:r,onSave:i,school:o,availableProviders:d}=e,[c,h]=(0,a.useState)(new Set),[u,x]=(0,a.useState)(""),[f,b]=(0,a.useState)([]),[y,w]=(0,a.useState)(!1),[S,A]=(0,a.useState)(null),[P,k]=(0,a.useState)("replace");(0,a.useEffect)(()=>{o&&s&&h(new Set(o.assignedProviders.map(e=>e.userId)))},[o,s]),(0,a.useEffect)(()=>{E()},[d,u]);let E=()=>{let e=[...d];if(u){let s=u.toLowerCase();e=e.filter(e=>{var r,t;return(null===(r=e.displayName)||void 0===r?void 0:r.toLowerCase().includes(s))||(null===(t=e.email)||void 0===t?void 0:t.toLowerCase().includes(s))})}b(e)},C=e=>{let s=new Set(c);s.has(e)?s.delete(e):s.add(e),h(s)},z=async()=>{if(o)try{if(w(!0),A(null),"replace"===P)await et(o.schoolId,Array.from(c));else{let e=new Set(o.assignedProviders.map(e=>e.userId));if("add"===P)for(let s of Array.from(c))e.has(s)||await es(s,o.schoolId);else if("remove"===P)for(let s of Array.from(c))e.has(s)&&await er(s,o.schoolId)}i(),r()}catch(e){console.error("Error saving assignments:",e),A("Failed to save assignments. Please try again.")}finally{w(!1)}},I=e=>{let s=d.find(s=>s.id===e);return(null==s?void 0:s.displayName)||"Unknown Provider"},U=e=>(null==o?void 0:o.assignedProviders.some(s=>s.userId===e))||!1;return(0,t.jsx)(N.Vq,{open:s,onOpenChange:r,children:(0,t.jsxs)(N.cZ,{className:"sm:max-w-[700px] max-h-[80vh] overflow-y-auto",children:[(0,t.jsxs)(N.fK,{children:[(0,t.jsxs)(N.$N,{children:["Manage Providers for ",(null==o?void 0:o.schoolName)||"School"]}),(0,t.jsxs)(N.Be,{children:["Assign or remove providers from this school. Currently has"," ",(null==o?void 0:o.totalProviders)||0," providers assigned."]})]}),S&&(0,t.jsxs)(j.bZ,{variant:"destructive",children:[(0,t.jsx)(l.Z,{className:"h-4 w-4"}),(0,t.jsx)(j.X,{children:S})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assignment Mode"}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(v.z,{variant:"replace"===P?"default":"outline",size:"sm",onClick:()=>k("replace"),children:"Replace All"}),(0,t.jsx)(v.z,{variant:"add"===P?"default":"outline",size:"sm",onClick:()=>k("add"),children:"Add Providers"}),(0,t.jsx)(v.z,{variant:"remove"===P?"default":"outline",size:"sm",onClick:()=>k("remove"),children:"Remove Providers"})]}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["replace"===P&&"Replace all current assignments with selected providers","add"===P&&"Add selected providers to existing assignments","remove"===P&&"Remove selected providers from current assignments"]})]}),(0,t.jsxs)("div",{className:"status-brand p-3 rounded-lg",children:[(0,t.jsxs)("p",{className:"text-sm font-medium text-brand-primary",children:["Assignment Preview: ",(()=>{if("replace"===P)return c.size;if("add"===P){let e=new Set((null==o?void 0:o.assignedProviders.map(e=>e.userId))||[]),s=Array.from(c).filter(s=>!e.has(s));return((null==o?void 0:o.assignedProviders.length)||0)+s.length}if("remove"===P){let e=new Set((null==o?void 0:o.assignedProviders.map(e=>e.userId))||[]),s=Array.from(c).filter(s=>e.has(s));return Math.max(0,((null==o?void 0:o.assignedProviders.length)||0)-s.length)}return(null==o?void 0:o.assignedProviders.length)||0})()," total providers will be assigned"]}),c.size>0&&(0,t.jsxs)("div",{className:"mt-2 flex flex-wrap gap-1",children:[Array.from(c).slice(0,5).map(e=>(0,t.jsx)(p.C,{variant:"secondary",className:"text-xs",children:I(e)},e)),c.size>5&&(0,t.jsxs)(p.C,{variant:"secondary",className:"text-xs",children:["+",c.size-5," more"]})]})]})]}),(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(n.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,t.jsx)(g.I,{placeholder:"Search providers...",value:u,onChange:e=>x(e.target.value),className:"pl-10"})]}),(0,t.jsx)(v.z,{variant:"outline",size:"sm",onClick:()=>{c.size===f.length?h(new Set):h(new Set(f.map(e=>e.id)))},className:"whitespace-nowrap",children:c.size===f.length?"Deselect All":"Select All"})]})}),(0,t.jsxs)("div",{className:"border rounded-lg max-h-96 overflow-y-auto",children:[(0,t.jsx)("div",{className:"p-3 border-b bg-gray-50",children:(0,t.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:["Available Providers (",f.length,")"]})}),(0,t.jsxs)("div",{className:"divide-y divide-gray-200",children:[f.map(e=>{var s,r,a,i;let l=c.has(e.id),n=U(e.id);return(0,t.jsx)("div",{className:"p-3 hover:bg-gray-50",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(V,{checked:l,onCheckedChange:()=>C(e.id)}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.displayName||"No name"}),n&&(0,t.jsx)(p.C,{variant:"default",className:"text-xs",children:"Currently Assigned"}),(0,t.jsx)(p.C,{variant:e.isActive?"default":"secondary",className:"text-xs",children:e.isActive?"Active":"Inactive"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 mt-1",children:[(0,t.jsxs)("p",{className:"text-xs text-gray-500 flex items-center",children:[(0,t.jsx)(q.Z,{className:"h-3 w-3 mr-1"}),e.email]}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[(null===(s=e.assignedSchools)||void 0===s?void 0:s.length)||0," schools assigned"]}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 flex items-center",children:[(0,t.jsx)(m.Z,{className:"h-3 w-3 mr-1"}),"Joined"," ",(null===(i=e.createdAt)||void 0===i?void 0:null===(a=i.toDate)||void 0===a?void 0:null===(r=a.call(i))||void 0===r?void 0:r.toLocaleDateString())||"Unknown"]})]})]})]})},e.id)}),0===f.length&&(0,t.jsx)(Q.DE,{message:u?'No providers found matching "'.concat(u,'"'):"No providers available for assignment",className:"py-8"})]})]}),(0,t.jsxs)(N.cN,{children:[(0,t.jsx)(v.z,{type:"button",variant:"outline",onClick:r,children:"Cancel"}),(0,t.jsx)(H.fl,{onClick:z,isLoading:y,loadingText:"Saving...",className:"micro-scale ".concat("remove"===P?"bg-red-600 hover:bg-red-700":""),children:"replace"===P?"Replace Assignments":"add"===P?"Add Providers":"Remove Providers"})]})]})})}function eo(){let[e,s]=(0,a.useState)([]),[r,b]=(0,a.useState)([]),[y,N]=(0,a.useState)({totalSchools:0,schoolsWithProviders:0,schoolsWithoutProviders:0,totalAssignments:0,activeProviders:0}),[w,S]=(0,a.useState)([]),[A,P]=(0,a.useState)([]),[k,E]=(0,a.useState)(new Set),[C,z]=(0,a.useState)(""),[I,U]=(0,a.useState)("all"),[R,Z]=(0,a.useState)(!0),[L,O]=(0,a.useState)(null),[T,D]=(0,a.useState)(!1),[_,W]=(0,a.useState)(null);(0,a.useEffect)(()=>{F()},[]),(0,a.useEffect)(()=>{M()},[e,C,I]);let F=async()=>{try{Z(!0),O(null);let[e,r,t,a]=await Promise.all([ee(),ea(),el(),ei()]);s(e),N(r),S(t),P(a)}catch(e){console.error("Error loading assignments:",e),O("Failed to load assignments. Please try again.")}finally{Z(!1)}},M=()=>{let s=[...e];if(C){let e=C.toLowerCase();s=s.filter(s=>s.schoolName.toLowerCase().includes(e)||s.schoolAddress.toLowerCase().includes(e)||s.assignedProviders.some(s=>s.displayName.toLowerCase().includes(e)||s.userEmail.toLowerCase().includes(e)))}"all"!==I&&(s=s.filter(e=>"assigned"===I?e.totalProviders>0:0===e.totalProviders)),b(s)},J=(e,s)=>{let r=new Set(k);s?r.add(e):r.delete(e),E(r)},K=async(e,s)=>{try{await er(s,e),await F()}catch(e){console.error("Error removing provider:",e),O("Failed to remove provider")}},B=e=>{W(e),D(!0)};return R?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"School-Provider Assignments"})}),(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsxs)(f.Zb,{className:"animate-pulse",children:[(0,t.jsx)(f.Ol,{className:"pb-2",children:(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"})}),(0,t.jsx)(f.aY,{children:(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/2"})})]},s))})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"School-Provider Assignments"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Manage which providers are assigned to which schools"})]}),(0,t.jsxs)(v.z,{onClick:()=>D(!0),children:[(0,t.jsx)(i.Z,{className:"h-4 w-4 mr-2"}),"Bulk Assignment"]})]}),L&&(0,t.jsxs)(j.bZ,{variant:"destructive",children:[(0,t.jsx)(l.Z,{className:"h-4 w-4"}),(0,t.jsx)(j.X,{children:L})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:y.totalSchools}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Total Schools"})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:y.schoolsWithProviders}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"With Providers"})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-red-600",children:y.schoolsWithoutProviders}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"No Providers"})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:y.totalAssignments}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Total Assignments"})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:y.activeProviders}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Active Providers"})]})]}),A.length>0&&(0,t.jsxs)(j.bZ,{children:[(0,t.jsx)(l.Z,{className:"h-4 w-4"}),(0,t.jsxs)(j.X,{children:[(0,t.jsxs)("span",{className:"font-medium",children:[A.length," providers"]})," ","are not assigned to any schools:",(0,t.jsxs)("span",{className:"ml-2",children:[A.slice(0,3).map(e=>e.displayName).join(", "),A.length>3&&" +".concat(A.length-3," more")]})]})]}),(0,t.jsx)("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center space-x-4 flex-1",children:[(0,t.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,t.jsx)(n.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,t.jsx)(g.I,{placeholder:"Search schools or providers...",value:C,onChange:e=>z(e.target.value),className:"pl-10"})]}),(0,t.jsxs)("select",{value:I,onChange:e=>U(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"all",children:"All Schools"}),(0,t.jsx)("option",{value:"assigned",children:"With Providers"}),(0,t.jsx)("option",{value:"unassigned",children:"No Providers"})]}),(0,t.jsxs)(v.z,{variant:"outline",onClick:()=>{let e=new Blob([["School Name,School Address,Total Providers,Assigned Providers,Status",...r.map(e=>[e.schoolName,e.schoolAddress,e.totalProviders,e.assignedProviders.map(e=>e.displayName).join("; "),e.isActive?"Active":"Inactive"].join(","))].join("\n")],{type:"text/csv"}),s=window.URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="school-assignments-".concat(new Date().toISOString().split("T")[0],".csv"),t.click(),window.URL.revokeObjectURL(s)},children:[(0,t.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})}),k.size>0&&(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("span",{className:"text-sm font-medium text-blue-900",children:[k.size," schools selected"]}),(0,t.jsxs)(v.z,{variant:"outline",size:"sm",onClick:()=>{},children:[(0,t.jsx)(i.Z,{className:"h-4 w-4 mr-2"}),"Bulk Assign"]})]}),(0,t.jsx)(v.z,{variant:"ghost",size:"sm",onClick:()=>E(new Set),children:"Clear Selection"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border",children:[(0,t.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("h2",{className:"text-lg font-semibold",children:["School Assignments (",r.length,")"]}),(0,t.jsxs)(v.z,{variant:"outline",size:"sm",onClick:()=>{k.size===r.length?E(new Set):E(new Set(r.map(e=>e.schoolId)))},className:"flex items-center",children:[k.size===r.length?(0,t.jsx)(d.Z,{className:"h-4 w-4 mr-2"}):(0,t.jsx)(c.Z,{className:"h-4 w-4 mr-2"}),"Select All"]})]})}),(0,t.jsxs)("div",{className:"divide-y divide-gray-200",children:[r.map(e=>{var s,r,a;return(0,t.jsx)("div",{className:"p-4 hover:bg-gray-50",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start space-x-4 flex-1",children:[(0,t.jsx)("input",{type:"checkbox",checked:k.has(e.schoolId),onChange:s=>J(e.schoolId,s.target.checked),className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:e.schoolName}),(0,t.jsx)(p.C,{variant:e.isActive?"default":"secondary",children:e.isActive?"Active":"Inactive"}),(0,t.jsxs)(p.C,{variant:e.totalProviders>0?"default":"destructive",children:[e.totalProviders," providers"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500 mb-3",children:[(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)(h.Z,{className:"h-3 w-3 mr-1"}),e.schoolAddress]}),(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)(m.Z,{className:"h-3 w-3 mr-1"}),"Updated"," ",(null===(a=e.lastUpdated)||void 0===a?void 0:null===(r=a.toDate)||void 0===r?void 0:null===(s=r.call(a))||void 0===s?void 0:s.toLocaleDateString())||"Unknown"]})]}),e.assignedProviders.length>0?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Assigned Providers:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:e.assignedProviders.map(s=>(0,t.jsxs)("div",{className:"flex items-center space-x-1 bg-blue-50 px-2 py-1 rounded-lg",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-blue-900",children:s.displayName}),(0,t.jsx)(p.C,{variant:s.isActive?"default":"secondary",className:"text-xs",children:s.isActive?"Active":"Inactive"}),(0,t.jsx)(v.z,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0 text-red-600 hover:text-red-700",onClick:()=>K(e.schoolId,s.userId),children:(0,t.jsx)(u.Z,{className:"h-3 w-3"})})]},s.userId))})]}):(0,t.jsx)("div",{className:"text-sm text-gray-500 italic",children:"No providers assigned to this school"})]})]}),(0,t.jsx)("div",{className:"flex items-center space-x-2 ml-4",children:(0,t.jsxs)(v.z,{variant:"outline",size:"sm",onClick:()=>B(e),children:[(0,t.jsx)(i.Z,{className:"h-4 w-4 mr-1"}),"Manage"]})})]})},e.schoolId)}),0===r.length&&(0,t.jsxs)("div",{className:"p-8 text-center",children:[(0,t.jsx)(x.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500",children:"No schools found matching your criteria"})]})]})]}),(0,t.jsx)(en,{isOpen:T,onClose:()=>{D(!1),W(null)},onSave:F,school:_,availableProviders:w})]})}function ed(){return(0,t.jsx)(b.ProtectedRoute,{roles:["admin"],children:(0,t.jsx)(y.AdminNavigation,{children:(0,t.jsx)(eo,{})})})}},54761:function(e,s,r){"use strict";r.d(s,{TK:function(){return l},fl:function(){return n}});var t=r(57437);r(2265);var a=r(93448),i=r(51817);function l(e){let{size:s="md",variant:r="primary",showText:l=!1,text:n="Loading...",className:o,...d}=e,c={primary:"text-brand-primary",secondary:"text-muted-foreground",muted:"text-gray-400"};return(0,t.jsxs)("div",{className:(0,a.cn)("flex items-center justify-center",l&&"space-x-2",o),...d,children:[(0,t.jsx)(i.Z,{className:(0,a.cn)("animate-spin",{sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"}[s],c[r])}),l&&(0,t.jsx)("span",{className:(0,a.cn)("font-medium",{sm:"text-sm",md:"text-base",lg:"text-lg"}[s],c[r]),children:n})]})}function n(e){let{isLoading:s,children:r,loadingText:i,className:n,disabled:o,size:d="md",variant:c="default",...h}=e;return(0,t.jsxs)("button",{className:(0,a.cn)({default:"btn-brand-primary",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-brand-primary underline-offset-4 hover:underline"}[c],"relative flex items-center justify-center","transition-all duration-200","disabled:opacity-50 disabled:cursor-not-allowed",s&&"cursor-not-allowed",n),disabled:o||s,...h,children:[s&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)(l,{size:"sm"===d?"sm":"lg"===d?"md":"sm",variant:"secondary",showText:!!i,text:i})}),(0,t.jsx)("span",{className:(0,a.cn)("transition-opacity duration-200",s?"opacity-0":"opacity-100"),children:r})]})}}},function(e){e.O(0,[609,15,569,806,145,972,691,258,304,695,95,971,208,744],function(){return e(e.s=63406)}),_N_E=e.O()}]);