try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},r=(new e.Error).stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="aeb29dfb-1c63-4093-b86d-1b744283dafd",e._sentryDebugIdIdentifier="sentry-dbid-aeb29dfb-1c63-4093-b86d-1b744283dafd")}()}catch(e){}(()=>{var e={};e.id=657,e.ids=[657],e.modules={48872:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=48872,e.exports=r},95653:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=95653,e.exports=r},98005:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=98005,e.exports=r},83293:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=83293,e.exports=r},12308:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=12308,e.exports=r},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},61212:e=>{"use strict";e.exports=require("async_hooks")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},27920:e=>{"use strict";e.exports=require("diagnostics_channel")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},85807:e=>{"use strict";e.exports=require("module")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},96119:e=>{"use strict";e.exports=require("perf_hooks")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},6162:e=>{"use strict";e.exports=require("worker_threads")},71568:e=>{"use strict";e.exports=require("zlib")},17718:e=>{"use strict";e.exports=require("node:child_process")},65714:e=>{"use strict";e.exports=require("node:diagnostics_channel")},87561:e=>{"use strict";e.exports=require("node:fs")},88849:e=>{"use strict";e.exports=require("node:http")},22286:e=>{"use strict";e.exports=require("node:https")},85690:e=>{"use strict";e.exports=require("node:inspector")},87503:e=>{"use strict";e.exports=require("node:net")},70612:e=>{"use strict";e.exports=require("node:os")},49411:e=>{"use strict";e.exports=require("node:path")},51747:e=>{"use strict";e.exports=require("node:readline")},84492:e=>{"use strict";e.exports=require("node:stream")},31764:e=>{"use strict";e.exports=require("node:tls")},47261:e=>{"use strict";e.exports=require("node:util")},24086:e=>{"use strict";e.exports=require("node:worker_threads")},65628:e=>{"use strict";e.exports=require("node:zlib")},84103:(e,r,t)=>{"use strict";t.r(r),t.d(r,{originalPathname:()=>D,patchFetch:()=>A,requestAsyncStorage:()=>T,routeModule:()=>I,serverHooks:()=>U,staticGenerationAsyncStorage:()=>b});var s={};t.r(s),t.d(s,{DELETE:()=>N,GET:()=>g,HEAD:()=>m,OPTIONS:()=>v,PATCH:()=>E,POST:()=>w,PUT:()=>S});var o=t(32829),i=t(85358),n=t(66806),a=t(54580),u=t(46485),c=t(54232),d=t(52489),p=t(21967);async function l(e){try{let r;let{searchParams:t}=new URL(e.url),s=t.get("providerId");return r=s?await (0,c.f9)(s):await (0,c._N)(c.Ul.LOCATIONS),u.NextResponse.json({schools:r})}catch(e){return console.error("Error fetching schools:",e),u.NextResponse.json({error:"Failed to fetch schools"},{status:500})}}async function h(e){try{let{name:r,address:t,coordinates:s,radius:o,assignedProviders:i}=await e.json();if(!r||!t||!s||!o)return u.NextResponse.json({error:"Name, address, coordinates, and radius are required"},{status:400});let n={name:r,address:t,coordinates:s,radius:Number(o),assignedProviders:i||[],isActive:!0,createdAt:d.EK.now(),updatedAt:d.EK.now()},a=await (0,c.OE)(c.Ul.LOCATIONS,n);return u.NextResponse.json({id:a,...n},{status:201})}catch(e){return console.error("Error creating school:",e),u.NextResponse.json({error:"Failed to create school"},{status:500})}}async function x(e){try{let{schoolId:r,name:t,address:s,coordinates:o,radius:i,assignedProviders:n,isActive:a}=await e.json();if(!r)return u.NextResponse.json({error:"School ID is required"},{status:400});let p={updatedAt:d.EK.now()};t&&(p.name=t),s&&(p.address=s),o&&(p.coordinates=o),void 0!==i&&(p.radius=Number(i)),n&&(p.assignedProviders=n),void 0!==a&&(p.isActive=a),await (0,c.gU)(c.Ul.LOCATIONS,r,p);let l=await (0,c.Me)(c.Ul.LOCATIONS,r);return u.NextResponse.json({id:r,...l||{}})}catch(e){return console.error("Error updating school:",e),u.NextResponse.json({error:"Failed to update school"},{status:500})}}async function f(e){try{let{searchParams:r}=new URL(e.url),t=r.get("schoolId");if(!t)return u.NextResponse.json({error:"School ID is required"},{status:400});return await (0,c.iH)(c.Ul.LOCATIONS,t),u.NextResponse.json({message:"School deleted successfully"})}catch(e){return console.error("Error deleting school:",e),u.NextResponse.json({error:"Failed to delete school"},{status:500})}}let y={...a},q="workUnitAsyncStorage"in y?y.workUnitAsyncStorage:"requestAsyncStorage"in y?y.requestAsyncStorage:void 0;function O(e,r){return"phase-production-build"===process.env.NEXT_PHASE||"function"!=typeof e?e:new Proxy(e,{apply:(e,t,s)=>{let o;try{let e=q?.getStore();o=e?.headers}catch{}return p.wrapRouteHandlerWithSentry(e,{method:r,parameterizedRoute:"/api/locations",headers:o}).apply(t,s)}})}let g=O(l,"GET"),w=O(h,"POST"),S=O(x,"PUT"),E=O(void 0,"PATCH"),N=O(f,"DELETE"),m=O(void 0,"HEAD"),v=O(void 0,"OPTIONS"),I=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/locations/route",pathname:"/api/locations",filename:"route",bundlePath:"app/api/locations/route"},resolvedPagePath:"/Users/arthurturnbull/Developer/schools-in/src/app/api/locations/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:T,staticGenerationAsyncStorage:b,serverHooks:U}=I,D="/api/locations/route";function A(){return(0,n.patchFetch)({serverHooks:U,staticGenerationAsyncStorage:b})}},54232:(e,r,t)=>{"use strict";t.d(r,{Ul:()=>c,OE:()=>d,iH:()=>h,_N:()=>x,Me:()=>p,f9:()=>f,sP:()=>y,gU:()=>l});var s=t(52489),o=t(58221),i=t(46696),n=t(14200);t(14389),t(21699);let a=(0,o.ZF)({apiKey:"AIzaSyB5GTFpkeRk7dIJL0hm1Xr5SBX_RQnqt_A",authDomain:"schools-in-check.firebaseapp.com",projectId:"schools-in-check",storageBucket:"schools-in-check.firebasestorage.app",messagingSenderId:"227078219689",appId:"1:227078219689:web:71408317e8899ed6fe46b8"});(0,i.v0)(a);let u=(0,s.ad)(a);(0,n.cF)(a);let c={USERS:"users",SESSIONS:"sessions",LOCATIONS:"locations"},d=async(e,r)=>(await (0,s.ET)((0,s.hJ)(u,e),r)).id,p=async(e,r)=>{let t=await (0,s.QT)((0,s.JU)(u,e,r));return t.exists()?{id:t.id,...t.data()}:null},l=async(e,r,t)=>{await (0,s.r7)((0,s.JU)(u,e,r),t)},h=async(e,r)=>{await (0,s.oe)((0,s.JU)(u,e,r))},x=async e=>(await (0,s.PL)((0,s.hJ)(u,e))).docs.map(e=>({id:e.id,...e.data()})),f=async e=>{let r=(0,s.IO)((0,s.hJ)(u,c.LOCATIONS),(0,s.ar)("assignedProviders","array-contains",e));return(await (0,s.PL)(r)).docs.map(e=>({id:e.id,...e.data()}))},y=async(e,r=1,t=10,o)=>{let i=[(0,s.ar)("userId","==",e)];o?.schoolId&&i.push((0,s.ar)("schoolId","==",o.schoolId));let n=(0,s.IO)((0,s.hJ)(u,c.SESSIONS),...i),a=(await (0,s.PL)(n)).size,d=(r-1)*t,p=[...i];if(o?.startDate&&p.push((0,s.ar)("checkInTime",">=",s.EK.fromDate(o.startDate))),o?.endDate){let e=new Date(o.endDate);e.setHours(23,59,59,999),p.push((0,s.ar)("checkInTime","<=",s.EK.fromDate(e)))}let l=(0,s.IO)((0,s.hJ)(u,c.SESSIONS),...p,(0,s.Xo)("checkInTime","desc"),(0,s.b9)(t+d+1)),h=(await (0,s.PL)(l)).docs;return{sessions:h.slice(d,d+t).map(e=>({id:e.id,...e.data()})),total:a,hasMore:h.length>d+t}}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[454,596],()=>t(84103));module.exports=s})();
//# sourceMappingURL=route.js.map