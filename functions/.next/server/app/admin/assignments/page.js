try{!function(){const e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="d674186a-befe-4b3e-ae5a-44dc95d80571",e._sentryDebugIdIdentifier="sentry-dbid-d674186a-befe-4b3e-ae5a-44dc95d80571")}()}catch(e){}(()=>{const e={};e.id=312,e.ids=[312],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},61212:e=>{"use strict";e.exports=require("async_hooks")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},27920:e=>{"use strict";e.exports=require("diagnostics_channel")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},85807:e=>{"use strict";e.exports=require("module")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},96119:e=>{"use strict";e.exports=require("perf_hooks")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},6162:e=>{"use strict";e.exports=require("worker_threads")},71568:e=>{"use strict";e.exports=require("zlib")},17718:e=>{"use strict";e.exports=require("node:child_process")},65714:e=>{"use strict";e.exports=require("node:diagnostics_channel")},87561:e=>{"use strict";e.exports=require("node:fs")},88849:e=>{"use strict";e.exports=require("node:http")},22286:e=>{"use strict";e.exports=require("node:https")},85690:e=>{"use strict";e.exports=require("node:inspector")},87503:e=>{"use strict";e.exports=require("node:net")},70612:e=>{"use strict";e.exports=require("node:os")},49411:e=>{"use strict";e.exports=require("node:path")},51747:e=>{"use strict";e.exports=require("node:readline")},84492:e=>{"use strict";e.exports=require("node:stream")},31764:e=>{"use strict";e.exports=require("node:tls")},47261:e=>{"use strict";e.exports=require("node:util")},24086:e=>{"use strict";e.exports=require("node:worker_threads")},65628:e=>{"use strict";e.exports=require("node:zlib")},62894:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ec});const r=t(28002),a=t(22488),i=t(84600),n=t(10499),o=t(91144),l=t(13765),c=t(82268),d=t(66693),u=t(81982),h=t(21301),m=t(55506),x=t(63883),p=t(34687),g=t(2227),v=t(16885),f=t(78620),y=t(78992),j=t(84643),b=t(89732),N=t(21250),w=t(19677),S=t(16769),k=t(58408),A=t(68878),P=t(57730),C=t(90027),E=t(22316),Z="Checkbox",[q,z]=(0,S.b)(Z),[U,I]=q(Z);function T(e){let{__scopeCheckbox:s,checked:t,children:i,defaultChecked:n,disabled:o,form:l,name:c,onCheckedChange:d,required:u,value:h="on",internal_do_not_use_render:m}=e,[x,p]=(0,A.T)({prop:t,defaultProp:n??!1,onChange:d,caller:Z}),[g,v]=a.useState(null),[f,y]=a.useState(null),j=a.useRef(!1),b=!g||!!l||!!g.closest("form"),N={checked:x,disabled:o,setChecked:p,control:g,setControl:v,name:c,form:l,value:h,hasConsumerStoppedPropagationRef:j,required:u,defaultChecked:!F(n)&&n,isFormControl:b,bubbleInput:f,setBubbleInput:y};return(0,r.jsx)(U,{scope:s,...N,children:"function"==typeof m?m(N):i})}const M="CheckboxTrigger",R=a.forwardRef(({__scopeCheckbox:e,onKeyDown:s,onClick:t,...i},n)=>{const{control:o,value:l,disabled:c,checked:d,required:u,setControl:h,setChecked:m,hasConsumerStoppedPropagationRef:x,isFormControl:p,bubbleInput:g}=I(M,e),v=(0,w.e)(n,h),f=a.useRef(d);return a.useEffect(()=>{const e=o?.form;if(e){const s=()=>m(f.current);return e.addEventListener("reset",s),()=>e.removeEventListener("reset",s)}},[o,m]),(0,r.jsx)(E.WV.button,{type:"button",role:"checkbox","aria-checked":F(d)?"mixed":d,"aria-required":u,"data-state":$(d),"data-disabled":c?"":void 0,disabled:c,value:l,...i,ref:v,onKeyDown:(0,k.Mj)(s,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,k.Mj)(t,e=>{m(e=>!!F(e)||!e),g&&p&&(x.current=e.isPropagationStopped(),x.current||e.stopPropagation())})})});R.displayName=M;const _=a.forwardRef((e,s)=>{const{__scopeCheckbox:t,name:a,checked:i,defaultChecked:n,required:o,disabled:l,value:c,onCheckedChange:d,form:u,...h}=e;return(0,r.jsx)(T,{__scopeCheckbox:t,checked:i,defaultChecked:n,disabled:l,required:o,onCheckedChange:d,name:a,form:u,value:c,internal_do_not_use_render:({isFormControl:e})=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(R,{...h,ref:s,__scopeCheckbox:t}),e&&(0,r.jsx)(W,{__scopeCheckbox:t})]})})});_.displayName=Z;const D="CheckboxIndicator",L=a.forwardRef((e,s)=>{let{__scopeCheckbox:t,forceMount:a,...i}=e,n=I(D,t);return(0,r.jsx)(C.z,{present:a||F(n.checked)||!0===n.checked,children:(0,r.jsx)(E.WV.span,{"data-state":$(n.checked),"data-disabled":n.disabled?"":void 0,...i,ref:s,style:{pointerEvents:"none",...e.style}})})});L.displayName=D;var O="CheckboxBubbleInput",W=a.forwardRef(({__scopeCheckbox:e,...s},t)=>{const{control:i,hasConsumerStoppedPropagationRef:n,checked:o,defaultChecked:l,required:c,disabled:d,name:u,value:h,form:m,bubbleInput:x,setBubbleInput:p}=I(O,e),g=(0,w.e)(t,p),v=function(e){const s=a.useRef({value:e,previous:e});return a.useMemo(()=>(s.current.value!==e&&(s.current.previous=s.current.value,s.current.value=e),s.current.previous),[e])}(o),f=function(e){const[s,t]=a.useState(void 0);return(0,P.b)(()=>{if(e){t({width:e.offsetWidth,height:e.offsetHeight});const s=new ResizeObserver(s=>{let r,a;if(!Array.isArray(s)||!s.length)return;const i=s[0];if("borderBoxSize"in i){const e=i.borderBoxSize,s=Array.isArray(e)?e[0]:e;r=s.inlineSize,a=s.blockSize}else r=e.offsetWidth,a=e.offsetHeight;t({width:r,height:a})});return s.observe(e,{box:"border-box"}),()=>s.unobserve(e)}t(void 0)},[e]),s}(i);a.useEffect(()=>{if(!x)return;const e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,s=!n.current;if(v!==o&&e){const t=new Event("click",{bubbles:s});x.indeterminate=F(o),e.call(x,!F(o)&&o),x.dispatchEvent(t)}},[x,v,o,n]);const y=a.useRef(!F(o)&&o);return(0,r.jsx)(E.WV.input,{type:"checkbox","aria-hidden":!0,defaultChecked:l??y.current,required:c,disabled:d,name:u,value:h,form:m,...s,tabIndex:-1,ref:g,style:{...s.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function F(e){return"indeterminate"===e}function $(e){return F(e)?"indeterminate":e?"checked":"unchecked"}W.displayName=O;const J=t(4432),X=t(73521);const K=a.forwardRef(({className:e,...s},t)=>r.jsx(_,{ref:t,className:(0,X.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...s,children:r.jsx(L,{className:(0,X.cn)("flex items-center justify-center text-current"),children:r.jsx(J.Z,{className:"h-4 w-4"})})}));K.displayName=_.displayName;const V=t(25745),B=t(64036),G=t(87597),Y=t(61694),H=t(41662),Q=t(66204);const ee=async()=>{try{const e=(0,Y.IO)((0,Y.hJ)(H.db,Q.Ul.LOCATIONS),(0,Y.Xo)("name")),s=await (0,Y.PL)(e),t=(0,Y.IO)((0,Y.hJ)(H.db,Q.Ul.USERS),(0,Y.ar)("role","==","provider")),r=(await (0,Y.PL)(t)).docs.map(e=>({id:e.id,...e.data()})),a=[];for(const e of s.docs){const s=e.data(),t=e.id,i=r.filter(e=>e.assignedSchools?.includes(t)).map(e=>({userId:e.id,userEmail:e.email||"",displayName:e.displayName||"Unknown",assignedAt:e.createdAt||Y.EK.now(),isActive:e.isActive}));a.push({schoolId:t,schoolName:s.name||"Unknown School",schoolAddress:s.address||"",assignedProviders:i,isActive:!1!==s.isActive,totalProviders:i.length,lastUpdated:s.updatedAt||s.createdAt||Y.EK.now()})}return a}catch(e){throw console.error("Error getting school assignments:",e),Error("Failed to fetch school assignments")}},es=async(e,s)=>{try{const t=(0,Y.JU)(H.db,Q.Ul.USERS,e),r=await (0,Y.QT)(t);if(!r.exists())throw Error("Provider not found");const a=r.data().assignedSchools||[];if(!a.includes(s)){const e=[...a,s];await (0,Y.r7)(t,{assignedSchools:e,updatedAt:Y.EK.now()})}}catch(e){throw console.error("Error assigning provider to school:",e),Error("Failed to assign provider to school")}},et=async(e,s)=>{try{const t=(0,Y.JU)(H.db,Q.Ul.USERS,e),r=await (0,Y.QT)(t);if(!r.exists())throw Error("Provider not found");const a=(r.data().assignedSchools||[]).filter(e=>e!==s);await (0,Y.r7)(t,{assignedSchools:a,updatedAt:Y.EK.now()})}catch(e){throw console.error("Error removing provider from school:",e),Error("Failed to remove provider from school")}},er=async(e,s)=>{try{const t=(0,Y.IO)((0,Y.hJ)(H.db,Q.Ul.USERS),(0,Y.ar)("role","==","provider")),r=await (0,Y.PL)(t),a=(0,Y.qs)(H.db),i=Y.EK.now();for(const t of r.docs){const r=t.id,n=(t.data().assignedSchools||[]).filter(s=>s!==e);s.includes(r)&&n.push(e),a.update((0,Y.JU)(H.db,Q.Ul.USERS,r),{assignedSchools:n,updatedAt:i})}await a.commit()}catch(e){throw console.error("Error replacing school assignments:",e),Error("Failed to replace school assignments")}},ea=async()=>{try{const e=await ee(),s=e.filter(e=>e.totalProviders>0).length,t=e.reduce((e,s)=>e+s.totalProviders,0),r=new Set;return e.forEach(e=>{e.assignedProviders.forEach(e=>{e.isActive&&r.add(e.userId)})}),{totalSchools:e.length,schoolsWithProviders:s,schoolsWithoutProviders:e.length-s,totalAssignments:t,activeProviders:r.size}}catch(e){throw console.error("Error getting assignment stats:",e),Error("Failed to fetch assignment statistics")}},ei=async()=>{try{const e=(0,Y.IO)((0,Y.hJ)(H.db,Q.Ul.USERS),(0,Y.ar)("role","==","provider"),(0,Y.ar)("isActive","==",!0));return(await (0,Y.PL)(e)).docs.map(e=>({id:e.id,...e.data()})).filter(e=>!e.assignedSchools||0===e.assignedSchools.length)}catch(e){throw console.error("Error getting unassigned providers:",e),Error("Failed to fetch unassigned providers")}},en=async()=>{try{const e=(0,Y.IO)((0,Y.hJ)(H.db,Q.Ul.USERS),(0,Y.ar)("role","==","provider"),(0,Y.ar)("isActive","==",!0),(0,Y.Xo)("displayName"));return(await (0,Y.PL)(e)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw console.error("Error getting available providers:",e),Error("Failed to fetch available providers")}};function eo({isOpen:e,onClose:s,onSave:t,school:i,availableProviders:l}){const[c,d]=(0,a.useState)(new Set),[u,m]=(0,a.useState)(""),[x,v]=(0,a.useState)([]),[j,b]=(0,a.useState)(!1),[w,S]=(0,a.useState)(null),[k,A]=(0,a.useState)("replace"),P=e=>{const s=new Set(c);s.has(e)?s.delete(e):s.add(e),d(s)},C=async()=>{if(i)try{if(b(!0),S(null),"replace"===k)await er(i.schoolId,Array.from(c));else{const e=new Set(i.assignedProviders.map(e=>e.userId));if("add"===k)for(const s of Array.from(c))e.has(s)||await es(s,i.schoolId);else if("remove"===k)for(const s of Array.from(c))e.has(s)&&await et(s,i.schoolId)}t(),s()}catch(e){console.error("Error saving assignments:",e),S("Failed to save assignments. Please try again.")}finally{b(!1)}},E=e=>{const s=l.find(s=>s.id===e);return s?.displayName||"Unknown Provider"},Z=e=>i?.assignedProviders.some(s=>s.userId===e)||!1;return r.jsx(N.Vq,{open:e,onOpenChange:s,children:(0,r.jsxs)(N.cZ,{className:"sm:max-w-[700px] max-h-[80vh] overflow-y-auto",children:[(0,r.jsxs)(N.fK,{children:[(0,r.jsxs)(N.$N,{children:["Manage Providers for ",i?.schoolName||"School"]}),(0,r.jsxs)(N.Be,{children:["Assign or remove providers from this school. Currently has"," ",i?.totalProviders||0," providers assigned."]})]}),w&&(0,r.jsxs)(y.bZ,{variant:"destructive",children:[r.jsx(n.Z,{className:"h-4 w-4"}),r.jsx(y.X,{children:w})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assignment Mode"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[r.jsx(p.z,{variant:"replace"===k?"default":"outline",size:"sm",onClick:()=>A("replace"),children:"Replace All"}),r.jsx(p.z,{variant:"add"===k?"default":"outline",size:"sm",onClick:()=>A("add"),children:"Add Providers"}),r.jsx(p.z,{variant:"remove"===k?"default":"outline",size:"sm",onClick:()=>A("remove"),children:"Remove Providers"})]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["replace"===k&&"Replace all current assignments with selected providers","add"===k&&"Add selected providers to existing assignments","remove"===k&&"Remove selected providers from current assignments"]})]}),(0,r.jsxs)("div",{className:"status-brand p-3 rounded-lg",children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-brand-primary",children:["Assignment Preview: ",(()=>{if("replace"===k)return c.size;if("add"===k){const e=new Set(i?.assignedProviders.map(e=>e.userId)||[]),s=Array.from(c).filter(s=>!e.has(s));return(i?.assignedProviders.length||0)+s.length}if("remove"===k){const e=new Set(i?.assignedProviders.map(e=>e.userId)||[]),s=Array.from(c).filter(s=>e.has(s));return Math.max(0,(i?.assignedProviders.length||0)-s.length)}return i?.assignedProviders.length||0})()," total providers will be assigned"]}),c.size>0&&(0,r.jsxs)("div",{className:"mt-2 flex flex-wrap gap-1",children:[Array.from(c).slice(0,5).map(e=>r.jsx(f.C,{variant:"secondary",className:"text-xs",children:E(e)},e)),c.size>5&&(0,r.jsxs)(f.C,{variant:"secondary",className:"text-xs",children:["+",c.size-5," more"]})]})]})]}),r.jsx("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[r.jsx(o.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),r.jsx(g.I,{placeholder:"Search providers...",value:u,onChange:e=>m(e.target.value),className:"pl-10"})]}),r.jsx(p.z,{variant:"outline",size:"sm",onClick:()=>{c.size===x.length?d(new Set):d(new Set(x.map(e=>e.id)))},className:"whitespace-nowrap",children:c.size===x.length?"Deselect All":"Select All"})]})}),(0,r.jsxs)("div",{className:"border rounded-lg max-h-96 overflow-y-auto",children:[r.jsx("div",{className:"p-3 border-b bg-gray-50",children:(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:["Available Providers (",x.length,")"]})}),(0,r.jsxs)("div",{className:"divide-y divide-gray-200",children:[x.map(e=>{const s=c.has(e.id),t=Z(e.id);return r.jsx("div",{className:"p-3 hover:bg-gray-50",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(K,{checked:s,onCheckedChange:()=>P(e.id)}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.displayName||"No name"}),t&&r.jsx(f.C,{variant:"default",className:"text-xs",children:"Currently Assigned"}),r.jsx(f.C,{variant:e.isActive?"default":"secondary",className:"text-xs",children:e.isActive?"Active":"Inactive"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 mt-1",children:[(0,r.jsxs)("p",{className:"text-xs text-gray-500 flex items-center",children:[r.jsx(V.Z,{className:"h-3 w-3 mr-1"}),e.email]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[e.assignedSchools?.length||0," schools assigned"]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 flex items-center",children:[r.jsx(h.Z,{className:"h-3 w-3 mr-1"}),"Joined"," ",e.createdAt?.toDate?.()?.toLocaleDateString()||"Unknown"]})]})]})]})},e.id)}),0===x.length&&r.jsx(G.DE,{message:u?`No providers found matching "${u}"`:"No providers available for assignment",className:"py-8"})]})]}),(0,r.jsxs)(N.cN,{children:[r.jsx(p.z,{type:"button",variant:"outline",onClick:s,children:"Cancel"}),r.jsx(B.fl,{onClick:C,isLoading:j,loadingText:"Saving...",className:`micro-scale ${"remove"===k?"bg-red-600 hover:bg-red-700":""}`,children:"replace"===k?"Replace Assignments":"add"===k?"Add Providers":"Remove Providers"})]})]})})}function el(){const[e,s]=(0,a.useState)([]),[t,j]=(0,a.useState)([]),[b,N]=(0,a.useState)({totalSchools:0,schoolsWithProviders:0,schoolsWithoutProviders:0,totalAssignments:0,activeProviders:0}),[w,S]=(0,a.useState)([]),[k,A]=(0,a.useState)([]),[P,C]=(0,a.useState)(new Set),[E,Z]=(0,a.useState)(""),[q,z]=(0,a.useState)("all"),[U,I]=(0,a.useState)(!0),[T,M]=(0,a.useState)(null),[R,_]=(0,a.useState)(!1),[D,L]=(0,a.useState)(null),O=async()=>{try{I(!0),M(null);const[e,t,r,a]=await Promise.all([ee(),ea(),en(),ei()]);s(e),N(t),S(r),A(a)}catch(e){console.error("Error loading assignments:",e),M("Failed to load assignments. Please try again.")}finally{I(!1)}},W=(e,s)=>{const t=new Set(P);s?t.add(e):t.delete(e),C(t)},F=async(e,s)=>{try{await et(s,e),await O()}catch(e){console.error("Error removing provider:",e),M("Failed to remove provider")}},$=e=>{L(e),_(!0)};return U?(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("h1",{className:"text-3xl font-bold",children:"School-Provider Assignments"})}),r.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,r.jsxs)(v.Zb,{className:"animate-pulse",children:[r.jsx(v.Ol,{className:"pb-2",children:r.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"})}),r.jsx(v.aY,{children:r.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})})]},s))})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"School-Provider Assignments"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage which providers are assigned to which schools"})]}),(0,r.jsxs)(p.z,{onClick:()=>_(!0),children:[r.jsx(i.Z,{className:"h-4 w-4 mr-2"}),"Bulk Assignment"]})]}),T&&(0,r.jsxs)(y.bZ,{variant:"destructive",children:[r.jsx(n.Z,{className:"h-4 w-4"}),r.jsx(y.X,{children:T})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[r.jsx("div",{className:"text-2xl font-bold text-gray-900",children:b.totalSchools}),r.jsx("div",{className:"text-sm text-gray-600",children:"Total Schools"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:b.schoolsWithProviders}),r.jsx("div",{className:"text-sm text-gray-600",children:"With Providers"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:b.schoolsWithoutProviders}),r.jsx("div",{className:"text-sm text-gray-600",children:"No Providers"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:b.totalAssignments}),r.jsx("div",{className:"text-sm text-gray-600",children:"Total Assignments"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[r.jsx("div",{className:"text-2xl font-bold text-purple-600",children:b.activeProviders}),r.jsx("div",{className:"text-sm text-gray-600",children:"Active Providers"})]})]}),k.length>0&&(0,r.jsxs)(y.bZ,{children:[r.jsx(n.Z,{className:"h-4 w-4"}),(0,r.jsxs)(y.X,{children:[(0,r.jsxs)("span",{className:"font-medium",children:[k.length," providers"]})," ","are not assigned to any schools:",(0,r.jsxs)("span",{className:"ml-2",children:[k.slice(0,3).map(e=>e.displayName).join(", "),k.length>3&&` +${k.length-3} more`]})]})]}),r.jsx("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4 flex-1",children:[(0,r.jsxs)("div",{className:"relative flex-1 max-w-md",children:[r.jsx(o.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),r.jsx(g.I,{placeholder:"Search schools or providers...",value:E,onChange:e=>Z(e.target.value),className:"pl-10"})]}),(0,r.jsxs)("select",{value:q,onChange:e=>z(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"all",children:"All Schools"}),r.jsx("option",{value:"assigned",children:"With Providers"}),r.jsx("option",{value:"unassigned",children:"No Providers"})]}),(0,r.jsxs)(p.z,{variant:"outline",onClick:()=>{const e=new Blob([["School Name,School Address,Total Providers,Assigned Providers,Status",...t.map(e=>[e.schoolName,e.schoolAddress,e.totalProviders,e.assignedProviders.map(e=>e.displayName).join("; "),e.isActive?"Active":"Inactive"].join(","))].join("\n")],{type:"text/csv"}),s=window.URL.createObjectURL(e),r=document.createElement("a");r.href=s,r.download=`school-assignments-${new Date().toISOString().split("T")[0]}.csv`,r.click(),window.URL.revokeObjectURL(s)},children:[r.jsx(l.Z,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})}),P.size>0&&(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("span",{className:"text-sm font-medium text-blue-900",children:[P.size," schools selected"]}),(0,r.jsxs)(p.z,{variant:"outline",size:"sm",onClick:()=>{},children:[r.jsx(i.Z,{className:"h-4 w-4 mr-2"}),"Bulk Assign"]})]}),r.jsx(p.z,{variant:"ghost",size:"sm",onClick:()=>C(new Set),children:"Clear Selection"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border",children:[r.jsx("div",{className:"p-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold",children:["School Assignments (",t.length,")"]}),(0,r.jsxs)(p.z,{variant:"outline",size:"sm",onClick:()=>{P.size===t.length?C(new Set):C(new Set(t.map(e=>e.schoolId)))},className:"flex items-center",children:[P.size===t.length?r.jsx(c.Z,{className:"h-4 w-4 mr-2"}):r.jsx(d.Z,{className:"h-4 w-4 mr-2"}),"Select All"]})]})}),(0,r.jsxs)("div",{className:"divide-y divide-gray-200",children:[t.map(e=>r.jsx("div",{className:"p-4 hover:bg-gray-50",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-4 flex-1",children:[r.jsx("input",{type:"checkbox",checked:P.has(e.schoolId),onChange:s=>W(e.schoolId,s.target.checked),className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:e.schoolName}),r.jsx(f.C,{variant:e.isActive?"default":"secondary",children:e.isActive?"Active":"Inactive"}),(0,r.jsxs)(f.C,{variant:e.totalProviders>0?"default":"destructive",children:[e.totalProviders," providers"]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500 mb-3",children:[(0,r.jsxs)("span",{className:"flex items-center",children:[r.jsx(u.Z,{className:"h-3 w-3 mr-1"}),e.schoolAddress]}),(0,r.jsxs)("span",{className:"flex items-center",children:[r.jsx(h.Z,{className:"h-3 w-3 mr-1"}),"Updated"," ",e.lastUpdated?.toDate?.()?.toLocaleDateString()||"Unknown"]})]}),e.assignedProviders.length>0?(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Assigned Providers:"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:e.assignedProviders.map(s=>(0,r.jsxs)("div",{className:"flex items-center space-x-1 bg-blue-50 px-2 py-1 rounded-lg",children:[r.jsx("span",{className:"text-sm font-medium text-blue-900",children:s.displayName}),r.jsx(f.C,{variant:s.isActive?"default":"secondary",className:"text-xs",children:s.isActive?"Active":"Inactive"}),r.jsx(p.z,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0 text-red-600 hover:text-red-700",onClick:()=>F(e.schoolId,s.userId),children:r.jsx(m.Z,{className:"h-3 w-3"})})]},s.userId))})]}):r.jsx("div",{className:"text-sm text-gray-500 italic",children:"No providers assigned to this school"})]})]}),r.jsx("div",{className:"flex items-center space-x-2 ml-4",children:(0,r.jsxs)(p.z,{variant:"outline",size:"sm",onClick:()=>$(e),children:[r.jsx(i.Z,{className:"h-4 w-4 mr-1"}),"Manage"]})})]})},e.schoolId)),0===t.length&&(0,r.jsxs)("div",{className:"p-8 text-center",children:[r.jsx(x.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-500",children:"No schools found matching your criteria"})]})]})]}),r.jsx(eo,{isOpen:R,onClose:()=>{_(!1),L(null)},onSave:O,school:D,availableProviders:w})]})}function ec(){return r.jsx(j.ProtectedRoute,{roles:["admin"],children:r.jsx(b.AdminNavigation,{children:r.jsx(el,{})})})}},15078:(e,s,t)=>{"use strict";let r;t.r(s),t.d(s,{default:()=>m,generateImageMetadata:()=>u,generateMetadata:()=>d,generateViewport:()=>h});const a=t(54580),i=t(17369),n=t(21967),o=(0,i.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/app/admin/assignments/page.tsx#default`);const l={...a},c="workUnitAsyncStorage"in l?l.workUnitAsyncStorage:"requestAsyncStorage"in l?l.requestAsyncStorage:void 0;r="function"==typeof o?new Proxy(o,{apply:(e,s,t)=>{let r,a,i;try{const e=c?.getStore();r=e?.headers.get("sentry-trace")??void 0,a=e?.headers.get("baggage")??void 0,i=e?.headers}catch{}return n.wrapServerComponentWithSentry(e,{componentRoute:"/admin/assignments",componentType:"Page",sentryTraceHeader:r,baggageHeader:a,headers:i}).apply(s,t)}}):o;const d=void 0,u=void 0,h=void 0,m=r},65390:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c}),t(15078),t(55157),t(26578),t(67641),t(14844);var r=t(95537),a=t(85358),i=t(24957),n=t.n(i),o=t(8666),l={};for(const e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);t.d(s,l);const c=["",{children:["admin",{children:["assignments",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,15078)),"/Users/arthurturnbull/Developer/schools-in/src/app/admin/assignments/page.tsx"]}]},{}]},{error:[()=>Promise.resolve().then(t.bind(t,55157)),"/Users/arthurturnbull/Developer/schools-in/src/app/admin/error.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,26578)),"/Users/arthurturnbull/Developer/schools-in/src/app/layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,67641)),"/Users/arthurturnbull/Developer/schools-in/src/app/error.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,14844)),"/Users/arthurturnbull/Developer/schools-in/src/app/not-found.tsx"]}],d=["/Users/arthurturnbull/Developer/schools-in/src/app/admin/assignments/page.tsx"],u="/admin/assignments/page",h={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/assignments/page",pathname:"/admin/assignments",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},49588:(e,s,t)=>{Promise.resolve().then(t.bind(t,62894))},21301:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});const r=(0,t(59141).Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},4432:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});const r=(0,t(59141).Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},85721:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});const r=(0,t(59141).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},25745:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});const r=(0,t(59141).Z)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},82268:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});const r=(0,t(59141).Z)("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},66693:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});const r=(0,t(59141).Z)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]])},84600:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});const r=(0,t(59141).Z)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},87597:(e,s,t)=>{"use strict";t.d(s,{DE:()=>y,Te:()=>g,XE:()=>f,ub:()=>v});const r=t(28002);t(22488);const a=t(8903),i=t(10499),n=t(81982),o=t(8991),l=t(63883),c=t(98979),d=t(51963),u=t(91144),h=t(81012),m=t(34687),x=t(78992),p=t(16885);function g({title:e,message:s,actionLabel:t="Try Again",onAction:l,type:c="generic",showRetry:d=!0,className:u=""}){const h=(()=>{switch(c){case"network":return{icon:a.Z,defaultTitle:"Connection Error",defaultMessage:"Unable to connect to the server. Please check your internet connection and try again.",iconColor:"text-red-500"};case"auth":return{icon:i.Z,defaultTitle:"Authentication Error",defaultMessage:"You need to be signed in to access this feature. Please sign in and try again.",iconColor:"text-orange-500"};case"location":return{icon:n.Z,defaultTitle:"Location Error",defaultMessage:"Unable to access your location. Please enable location services and try again.",iconColor:"text-blue-500"};case"permission":return{icon:i.Z,defaultTitle:"Permission Denied",defaultMessage:"You don't have permission to access this feature. Please contact your administrator.",iconColor:"text-red-500"};default:return{icon:i.Z,defaultTitle:"Something went wrong",defaultMessage:"An unexpected error occurred. Please try again.",iconColor:"text-red-500"}}})(),x=h.icon;return r.jsx(p.Zb,{className:`text-center ${u}`,children:r.jsx(p.aY,{className:"pt-6",children:(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[r.jsx(x,{className:`h-12 w-12 ${h.iconColor}`}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e||h.defaultTitle}),r.jsx("p",{className:"text-sm text-gray-600 max-w-sm",children:s||h.defaultMessage})]}),d&&l&&(0,r.jsxs)(m.z,{onClick:l,variant:"outline",className:"mt-4",children:[r.jsx(o.Z,{className:"h-4 w-4 mr-2"}),t]})]})})})}function v({title:e,message:s,actionLabel:t="Get Started",onAction:a,type:i="generic",showAction:n=!0,className:o=""}){const x=(()=>{switch(i){case"schools":return{icon:l.Z,defaultTitle:"No schools assigned",defaultMessage:"You don't have any schools assigned yet. Contact your administrator to get started.",defaultAction:"Contact Support",iconColor:"text-blue-500"};case"sessions":return{icon:c.Z,defaultTitle:"No sessions found",defaultMessage:"No check-in sessions have been recorded yet. Start your first session to see it here.",defaultAction:"Start Session",iconColor:"text-green-500"};case"users":return{icon:d.Z,defaultTitle:"No users found",defaultMessage:"No users match your current filters. Try adjusting your search criteria.",defaultAction:"Clear Filters",iconColor:"text-purple-500"};case"search":return{icon:u.Z,defaultTitle:"No results found",defaultMessage:"We couldn't find anything matching your search. Try different keywords or check your spelling.",defaultAction:"Clear Search",iconColor:"text-gray-500"};case"assignments":return{icon:h.Z,defaultTitle:"No assignments",defaultMessage:"No assignments have been created yet. Create your first assignment to get started.",defaultAction:"Create Assignment",iconColor:"text-indigo-500"};case"reports":return{icon:h.Z,defaultTitle:"No reports available",defaultMessage:"No reports are available for the selected criteria. Try adjusting your filters.",defaultAction:"Clear Filters",iconColor:"text-orange-500"};default:return{icon:h.Z,defaultTitle:"Nothing here yet",defaultMessage:"This section is empty. Start by adding some content.",defaultAction:"Get Started",iconColor:"text-gray-500"}}})(),g=x.icon;return r.jsx(p.Zb,{className:`text-center ${o}`,children:r.jsx(p.aY,{className:"pt-6",children:(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[r.jsx(g,{className:`h-12 w-12 ${x.iconColor}`}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e||x.defaultTitle}),r.jsx("p",{className:"text-sm text-gray-600 max-w-sm",children:s||x.defaultMessage})]}),n&&a&&r.jsx(m.z,{onClick:a,className:"mt-4",children:t||x.defaultAction})]})})})}function f({message:e="Something went wrong",onRetry:s,className:t=""}){return(0,r.jsxs)(x.bZ,{variant:"destructive",className:t,children:[r.jsx(i.Z,{className:"h-4 w-4"}),r.jsx(x.Cd,{children:"Error"}),(0,r.jsxs)(x.X,{className:"flex items-center justify-between",children:[r.jsx("span",{children:e}),s&&(0,r.jsxs)(m.z,{variant:"outline",size:"sm",onClick:s,className:"ml-2 h-7",children:[r.jsx(o.Z,{className:"h-3 w-3 mr-1"}),"Retry"]})]})]})}function y({message:e="Nothing to show",className:s=""}){return r.jsx("div",{className:`text-center py-8 text-gray-500 ${s}`,children:r.jsx("p",{className:"text-sm",children:e})})}},64036:(e,s,t)=>{"use strict";t.d(s,{TK:()=>n,fl:()=>o});const r=t(28002);t(22488);const a=t(73521),i=t(85721);function n({size:e="md",variant:s="primary",showText:t=!1,text:n="Loading...",className:o,...l}){const c={primary:"text-brand-primary",secondary:"text-muted-foreground",muted:"text-gray-400"};return(0,r.jsxs)("div",{className:(0,a.cn)("flex items-center justify-center",t&&"space-x-2",o),...l,children:[r.jsx(i.Z,{className:(0,a.cn)("animate-spin",{sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"}[e],c[s])}),t&&r.jsx("span",{className:(0,a.cn)("font-medium",{sm:"text-sm",md:"text-base",lg:"text-lg"}[e],c[s]),children:n})]})}function o({isLoading:e,children:s,loadingText:t,className:i,disabled:o,size:l="md",variant:c="default",...d}){return(0,r.jsxs)("button",{className:(0,a.cn)({default:"btn-brand-primary",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-brand-primary underline-offset-4 hover:underline"}[c],"relative flex items-center justify-center","transition-all duration-200","disabled:opacity-50 disabled:cursor-not-allowed",e&&"cursor-not-allowed",i),disabled:o||e,...d,children:[e&&r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsx(n,{size:"sm"===l?"sm":"lg"===l?"md":"sm",variant:"secondary",showText:!!t,text:t})}),r.jsx("span",{className:(0,a.cn)("transition-opacity duration-200",e?"opacity-0":"opacity-100"),children:s})]})}}};const s=require("../../../webpack-runtime.js");s.C(e);const t=e=>s(s.s=e),r=s.X(0,[454,982,5,750,146],()=>t(65390));module.exports=r})();
//# sourceMappingURL=page.js.map