try{!function(){const e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="da327026-9a36-49d8-a197-48256eddbf74",e._sentryDebugIdIdentifier="sentry-dbid-da327026-9a36-49d8-a197-48256eddbf74")}()}catch(e){}exports.id=750,exports.ids=[750],exports.modules={48872:e=>{function t(e){const t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=48872,e.exports=t},95653:e=>{function t(e){const t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=95653,e.exports=t},98005:e=>{function t(e){const t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=98005,e.exports=t},83293:e=>{function t(e){const t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=83293,e.exports=t},12308:e=>{function t(e){const t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=12308,e.exports=t},51979:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});const n=s(28002),a=s(43653),r=s(34687),i=s(16885),c=s(81982),o=s(42902),l=s(72943),d=s(92848),u=s(74068);function m(){const e=(0,u.useRouter)();return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center p-4",children:n.jsx(i.Zb,{className:"w-full max-w-md text-center",children:(0,n.jsxs)(i.aY,{className:"pt-8 pb-6",children:[n.jsx(a.T,{title:"Page Not Found",subtitle:"The page you're looking for doesn't exist.",className:"mb-6"}),n.jsx("div",{className:"flex justify-center mb-6",children:n.jsx("div",{className:"p-4 bg-red-50 rounded-full",children:n.jsx(c.Z,{className:"h-8 w-8 text-red-500"})})}),n.jsx("p",{className:"text-gray-600 mb-8",children:"Looks like you've wandered off the school grounds! Let's get you back to safety."}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[(0,n.jsxs)(r.z,{onClick:()=>e.back(),variant:"outline",className:"flex items-center gap-2",children:[n.jsx(o.Z,{className:"h-4 w-4"}),"Go Back"]}),n.jsx(d.default,{href:"/dashboard",children:(0,n.jsxs)(r.z,{className:"flex items-center gap-2 w-full sm:w-auto",children:[n.jsx(l.Z,{className:"h-4 w-4"}),"Dashboard"]})})]})]})})})}},26578:(e,t,s)=>{"use strict";let n;s.r(t),s.d(t,{default:()=>N,generateImageMetadata:()=>w,generateMetadata:()=>S,generateViewport:()=>v,metadata:()=>f,viewport:()=>g});const a=s(54580),r=s(35423),i=s(39212),c=s.n(i);s(5023);const o=s(17369);(0,o.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/components/provider/AuthProvider.tsx#AuthContext`);const l=(0,o.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/components/provider/AuthProvider.tsx#AuthProvider`),d=(0,o.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/components/layout/ClientLayout.tsx#default`);(0,o.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/lib/accessibility.tsx#ScreenReaderOnly`),(0,o.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/lib/accessibility.tsx#LiveRegion`);const u=(0,o.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/lib/accessibility.tsx#SkipToContent`);(0,o.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/lib/accessibility.tsx#useFocusTrap`),(0,o.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/lib/accessibility.tsx#useAnnouncement`),(0,o.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/lib/accessibility.tsx#useHighContrastMode`),(0,o.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/lib/accessibility.tsx#useReducedMotion`),(0,o.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/lib/accessibility.tsx#useKeyboardNavigation`),(0,o.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/lib/accessibility.tsx#ARIA`),(0,o.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/lib/accessibility.tsx#AnnouncementRegion`),(0,o.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/lib/accessibility.tsx#default`);const m=(0,o.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/components/common/NetworkStatusIndicator.tsx#NetworkStatusIndicator`),h=(0,o.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/lib/providers/AnalyticsProvider.tsx#AnalyticsProvider`);const y=s(21967);const f={title:"DMDL Schools-In - Provider Check-In System",description:"Professional location-based check-in system for education service providers",manifest:"/manifest.json",appleWebApp:{capable:!0,statusBarStyle:"default",title:"DMDL Schools-In"},icons:{icon:[{url:"/icon-192.png",sizes:"192x192",type:"image/png"},{url:"/icon-512.png",sizes:"512x512",type:"image/png"},{url:"/DMDL_logo.png",sizes:"280x60",type:"image/png"}],apple:[{url:"/icon-192.png",sizes:"192x192",type:"image/png"}]}},g={width:"device-width",initialScale:1,maximumScale:5,userScalable:!0,themeColor:"#154690",viewportFit:"cover"},p={...a},x="workUnitAsyncStorage"in p?p.workUnitAsyncStorage:"requestAsyncStorage"in p?p.requestAsyncStorage:void 0;n=new Proxy(function({children:e}){return(0,r.jsx)("html",{lang:"en",className:"h-full",children:(0,r.jsxs)("body",{className:`${c().className} h-full bg-background text-foreground antialiased`,children:[(0,r.jsx)(u,{}),(0,r.jsx)(l,{children:(0,r.jsx)(h,{children:(0,r.jsxs)("div",{className:"min-h-full safe-area-inset",children:[(0,r.jsx)(d,{children:e}),(0,r.jsx)(m,{})]})})})]})})},{apply:(e,t,s)=>{let n,a,r;try{const e=x?.getStore();n=e?.headers.get("sentry-trace")??void 0,a=e?.headers.get("baggage")??void 0,r=e?.headers}catch{}return y.wrapServerComponentWithSentry(e,{componentRoute:"/",componentType:"Layout",sentryTraceHeader:n,baggageHeader:a,headers:r}).apply(t,s)}});const S=void 0,w=void 0,v=void 0,N=n},14844:(e,t,s)=>{"use strict";let n;s.r(t),s.d(t,{default:()=>h,generateImageMetadata:()=>u,generateMetadata:()=>d,generateViewport:()=>m});const a=s(54580),r=s(17369),i=s(21967),c=(0,r.createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/app/not-found.tsx#default`);const o={...a},l="workUnitAsyncStorage"in o?o.workUnitAsyncStorage:"requestAsyncStorage"in o?o.requestAsyncStorage:void 0;n="function"==typeof c?new Proxy(c,{apply:(e,t,s)=>{let n,a,r;try{const e=l?.getStore();n=e?.headers.get("sentry-trace")??void 0,a=e?.headers.get("baggage")??void 0,r=e?.headers}catch{}return i.wrapServerComponentWithSentry(e,{componentRoute:"/",componentType:"Not-found",sentryTraceHeader:n,baggageHeader:a,headers:r}).apply(t,s)}}):c;const d=void 0,u=void 0,m=void 0,h=n},18026:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,93929,23)),Promise.resolve().then(s.t.bind(s,91956,23)),Promise.resolve().then(s.t.bind(s,3186,23)),Promise.resolve().then(s.t.bind(s,71640,23)),Promise.resolve().then(s.t.bind(s,92888,23)),Promise.resolve().then(s.t.bind(s,35946,23))},54559:(e,t,s)=>{Promise.resolve().then(s.bind(s,55365)),Promise.resolve().then(s.bind(s,95746)),Promise.resolve().then(s.bind(s,73940)),Promise.resolve().then(s.bind(s,82448)),Promise.resolve().then(s.bind(s,71641))},88577:(e,t,s)=>{Promise.resolve().then(s.bind(s,40918))},24089:(e,t,s)=>{Promise.resolve().then(s.bind(s,51979))},41662:(e,t,s)=>{"use strict";s.d(t,{I8:()=>o,Sv:()=>d,co:()=>u,db:()=>l});const n=s(25830),a=s(94018),r=s(61694),i=s(24345);s(77283),s(8194);const c=(0,n.ZF)({apiKey:"AIzaSyB5GTFpkeRk7dIJL0hm1Xr5SBX_RQnqt_A",authDomain:"schools-in-check.firebaseapp.com",projectId:"schools-in-check",storageBucket:"schools-in-check.firebasestorage.app",messagingSenderId:"227078219689",appId:"1:227078219689:web:71408317e8899ed6fe46b8"}),o=(0,a.v0)(c),l=(0,r.ad)(c);(0,i.cF)(c);const d=null,u=null},40918:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});const n=s(28002);s(22488);const a=s(34687),r=s(16885);function i({error:e,reset:t}){return n.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100 dark:bg-gray-900",children:(0,n.jsxs)(r.Zb,{className:"w-full max-w-md mx-4",children:[(0,n.jsxs)(r.Ol,{children:[n.jsx(r.ll,{className:"text-2xl font-bold text-center text-red-600",children:"Something went wrong!"}),n.jsx(r.SZ,{className:"text-center",children:"We encountered an unexpected error. Please try again."})]}),(0,n.jsxs)(r.aY,{className:"flex flex-col items-center space-y-4",children:[n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Error details have been logged for review."}),e?.digest&&(0,n.jsxs)("p",{className:"text-xs text-gray-500",children:["Error Digest: ",e.digest]}),n.jsx(a.z,{onClick:()=>t(),children:"Try again"})]})]})})}},55365:(e,t,s)=>{"use strict";s.d(t,{NetworkStatusIndicator:()=>i});const n=s(28002),a=s(8903),r=s(42362);function i(){const{isOnline:e}=(0,r.k)();return e?null:(0,n.jsxs)("div",{className:"fixed bottom-0 left-0 right-0 bg-red-600 text-white p-4 text-center z-50 flex items-center justify-center",children:[n.jsx(a.Z,{className:"mr-2 h-5 w-5"}),n.jsx("p",{children:"You are currently offline. Some features may be unavailable."})]})}},95746:(e,t,s)=>{"use strict";s.d(t,{default:()=>eU});const n=s(28002),a=s(96800),r=s(93423),i=s(34687),c=s(56676),o=s(74068),l=s(92848),d=s(22488),u=s(16885),m=s(13765),h=s(55506);function y(){const[e,t]=(0,d.useState)(null),[s,a]=(0,d.useState)(!1),[r,c]=(0,d.useState)(!1),o=async()=>{if(!e)return;await e.prompt();const{outcome:s}=await e.userChoice;"accepted"===s?console.log("User accepted the install prompt"):console.log("User dismissed the install prompt"),t(null),a(!1)},l=()=>{a(!1),sessionStorage.setItem("pwa-prompt-dismissed","true")};return r||!s||sessionStorage.getItem("pwa-prompt-dismissed")?null:(0,n.jsxs)(u.Zb,{className:"mb-4 status-brand border",children:[(0,n.jsxs)(u.Ol,{className:"pb-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[n.jsx(m.Z,{className:"h-5 w-5 text-brand-primary"}),n.jsx(u.ll,{className:"text-lg text-brand-primary",children:"Install Schools In"})]}),n.jsx(i.z,{variant:"ghost",size:"sm",onClick:l,children:n.jsx(h.Z,{className:"h-4 w-4"})})]}),n.jsx(u.SZ,{className:"text-brand-primary/80",children:"Install the app for faster access and offline functionality"})]}),n.jsx(u.aY,{className:"pt-0",children:(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsxs)(i.z,{onClick:o,className:"btn-brand-primary",children:[n.jsx(m.Z,{className:"h-4 w-4 mr-2"}),"Install App"]}),n.jsx(i.z,{variant:"outline",onClick:l,children:"Not Now"})]})})]})}const f=s(8991);function g(){const[e,t]=(0,d.useState)(!1),[s,a]=(0,d.useState)(null),r=()=>{t(!1)};return e?(0,n.jsxs)(u.Zb,{className:"mb-4 border-green-200 bg-green-50",children:[(0,n.jsxs)(u.Ol,{className:"pb-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[n.jsx(f.Z,{className:"h-5 w-5 text-green-600"}),n.jsx(u.ll,{className:"text-lg text-green-900",children:"Update Available"})]}),n.jsx(i.z,{variant:"ghost",size:"sm",onClick:r,children:n.jsx(h.Z,{className:"h-4 w-4"})})]}),n.jsx(u.SZ,{className:"text-green-700",children:"A new version of Schools In is available with improvements and bug fixes"})]}),n.jsx(u.aY,{className:"pt-0",children:(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsxs)(i.z,{onClick:()=>{s?.waiting&&s.waiting.postMessage({type:"SKIP_WAITING"}),t(!1)},className:"bg-green-600 hover:bg-green-700",children:[n.jsx(f.Z,{className:"h-4 w-4 mr-2"}),"Update Now"]}),n.jsx(i.z,{variant:"outline",onClick:r,children:"Later"})]})})]}):null}const p=s(78620),x=s(71010),S=s(8903),w=s(98979),v=s(492),N=s(38614),b=s(41518);const j={SCHOOLS:"schools",SESSIONS:"sessions",PENDING_ACTIONS:"pending-actions",USER_DATA:"user-data"};async function A(){return(0,b.X3)("schools-in-offline",1,{upgrade(e){if(e.objectStoreNames.contains(j.SCHOOLS)||e.createObjectStore(j.SCHOOLS,{keyPath:"id"}).createIndex("name","name"),!e.objectStoreNames.contains(j.SESSIONS)){const t=e.createObjectStore(j.SESSIONS,{keyPath:"id"});t.createIndex("userId","userId"),t.createIndex("schoolId","schoolId"),t.createIndex("startTime","startTime")}if(!e.objectStoreNames.contains(j.PENDING_ACTIONS)){const t=e.createObjectStore(j.PENDING_ACTIONS,{keyPath:"id",autoIncrement:!0});t.createIndex("timestamp","timestamp"),t.createIndex("type","type")}e.objectStoreNames.contains(j.USER_DATA)||e.createObjectStore(j.USER_DATA,{keyPath:"id"})}})}async function C(e){const t=(await A()).transaction(j.SCHOOLS,"readwrite");for(const s of e)await t.store.put(s);await t.done}async function k(e){const t=await A(),s=await t.getAll(j.SCHOOLS);return e?s.filter(t=>t.assignedProviders?.includes(e)):s}async function I(e){const t=(await A()).transaction(j.SESSIONS,"readwrite");for(const s of e)await t.store.put(s);await t.done}async function O(e){const t=await A();return e?await t.getAllFromIndex(j.SESSIONS,"userId",e):await t.getAll(j.SESSIONS)}async function E(e){const t=await A();await t.add(j.PENDING_ACTIONS,{...e,timestamp:e.timestamp||Date.now(),retry:e.retry||0})}async function T(e){const t=await A();await t.put(j.USER_DATA,{id:"current-user",...e})}async function _(){const e=await A();return await e.get(j.USER_DATA,"current-user")}async function D(){const e=await A();for(const t of(await e.getAll(j.PENDING_ACTIONS)))try{let s;if("check-in"===t.type)s=await fetch("/api/sessions/check-in",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.data)});else{if("check-out"!==t.type)continue;s=await fetch("/api/sessions/check-out",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.data)})}s.ok?await e.delete(j.PENDING_ACTIONS,t.id):(t.retry=(t.retry||0)+1,await e.put(j.PENDING_ACTIONS,t))}catch(s){console.error("Failed to sync action:",s),t.retry=(t.retry||0)+1,await e.put(j.PENDING_ACTIONS,t)}}async function P(){const e=await A();await Promise.all([e.clear(j.SCHOOLS),e.clear(j.SESSIONS),e.clear(j.PENDING_ACTIONS),e.clear(j.USER_DATA)])}class R{constructor(){this.isOnline=!0,this.syncInProgress=!1}static getInstance(){return R.instance||(R.instance=new R),R.instance}setupEventListeners(){window.addEventListener("online",()=>{this.isOnline=!0,this.onOnline()}),window.addEventListener("offline",()=>{this.isOnline=!1,this.onOffline()}),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",e=>{this.handleServiceWorkerMessage(e)})}async initializeOfflineDB(){try{await A(),console.log("Offline database initialized")}catch(e){console.error("Failed to initialize offline database:",e)}}async onOnline(){console.log("Device came online"),this.syncInProgress||await this.performBackgroundSync(),this.notifyStatusChange("online")}onOffline(){console.log("Device went offline"),this.notifyStatusChange("offline")}handleServiceWorkerMessage(e){const{data:t}=e;switch(t.type){case"BACKGROUND_SYNC":this.performBackgroundSync();break;case"CACHE_UPDATE":this.notifyStatusChange("cache-updated");break;default:console.log("Unknown service worker message:",t)}}notifyStatusChange(e){window.dispatchEvent(new CustomEvent("service-manager-status",{detail:{status:e,isOnline:this.isOnline}}))}isDeviceOnline(){return this.isOnline}async cacheUserSchools(e){try{await C(e),console.log(`Cached ${e.length} schools for offline use`)}catch(e){console.error("Failed to cache school data:",e)}}async getOfflineSchools(e){try{return await k(e)}catch(e){return console.error("Failed to get offline schools:",e),[]}}async cacheUserSessions(e){try{await I(e),console.log(`Cached ${e.length} sessions for offline use`)}catch(e){console.error("Failed to cache session data:",e)}}async getOfflineSessions(e){try{return await O(e)}catch(e){return console.error("Failed to get offline sessions:",e),[]}}async performOfflineCheckIn(e){try{if(this.isOnline){const t=await fetch("/api/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Check-in failed");return await t.json()}{await E({type:"check-in",data:e,timestamp:Date.now()});const t={id:`offline-${Date.now()}`,...e,status:"pending-sync",startTime:new Date(e.timestamp).toISOString()};return await I([t]),console.log("Check-in queued for offline sync"),t}}catch(e){throw console.error("Check-in error:",e),e}}async performOfflineCheckOut(e){try{if(!this.isOnline)return await E({type:"check-out",data:e,timestamp:Date.now()}),console.log("Check-out queued for offline sync"),{status:"pending-sync"};{const t=await fetch(`/api/sessions/${e.sessionId}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({endTime:new Date(e.timestamp).toISOString(),endCoordinates:e.coordinates,status:"completed"})});if(!t.ok)throw Error("Check-out failed");return await t.json()}}catch(e){throw console.error("Check-out error:",e),e}}async performBackgroundSync(){if(!this.syncInProgress&&this.isOnline){this.syncInProgress=!0,console.log("Starting background sync...");try{await D(),console.log("Background sync completed"),this.notifyStatusChange("sync-completed")}catch(e){console.error("Background sync failed:",e),this.notifyStatusChange("sync-failed")}finally{this.syncInProgress=!1}}}async cacheCurrentUser(e){try{await T(e)}catch(e){console.error("Failed to cache user data:",e)}}async getOfflineUserData(){try{return await _()}catch(e){return console.error("Failed to get offline user data:",e),null}}async clearAllOfflineData(){try{await P(),console.log("All offline data cleared")}catch(e){console.error("Failed to clear offline data:",e)}}getSyncStatus(){return{isOnline:this.isOnline,syncInProgress:this.syncInProgress}}}const M=R.getInstance();function U(){const[e,t]=(0,d.useState)(!1),[s,a]=(0,d.useState)("not-supported"),{isOnline:r,syncInProgress:i,lastSyncTime:c}=function(){const[e,t]=(0,d.useState)({isOnline:!0,syncInProgress:!1,pendingActions:0,lastSyncTime:null}),s=(0,d.useCallback)(async e=>{try{t(e=>({...e,syncInProgress:!0}));const s=await M.performOfflineCheckIn(e);return t(e=>({...e,syncInProgress:!1})),s}catch(e){throw t(e=>({...e,syncInProgress:!1})),e}},[]),n=(0,d.useCallback)(async e=>{try{t(e=>({...e,syncInProgress:!0}));const s=await M.performOfflineCheckOut(e);return t(e=>({...e,syncInProgress:!1})),s}catch(e){throw t(e=>({...e,syncInProgress:!1})),e}},[]),a=(0,d.useCallback)(async e=>await M.getOfflineSchools(e),[]),r=(0,d.useCallback)(async e=>await M.getOfflineSessions(e),[]),i=(0,d.useCallback)(async()=>{t(e=>({...e,syncInProgress:!0}));try{await M.performBackgroundSync(),t(e=>({...e,syncInProgress:!1,lastSyncTime:new Date}))}catch(e){throw t(e=>({...e,syncInProgress:!1})),e}},[]),c=(0,d.useCallback)(async()=>{await M.clearAllOfflineData(),t(e=>({...e,pendingActions:0,lastSyncTime:null}))},[]);return{isOnline:e.isOnline,syncInProgress:e.syncInProgress,lastSyncTime:e.lastSyncTime,checkInOffline:s,checkOutOffline:n,syncOfflineActions:i,getCachedSchools:a,getCachedSessions:r,clearOfflineData:c}}();return(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)(p.C,{variant:r?"secondary":"destructive",className:"flex items-center gap-1",children:[r?n.jsx(x.Z,{className:"h-3 w-3"}):n.jsx(S.Z,{className:"h-3 w-3"}),r?"Online":"Offline"]}),i&&(0,n.jsxs)(p.C,{variant:"outline",className:"flex items-center gap-1",children:[n.jsx(f.Z,{className:"h-3 w-3 animate-spin"}),"Syncing"]}),c&&!i&&(0,n.jsxs)(p.C,{variant:"outline",className:"flex items-center gap-1",children:[n.jsx(w.Z,{className:"h-3 w-3"}),"Synced ",new Date(c).toLocaleTimeString()]}),e&&(0,n.jsxs)(p.C,{variant:"default",className:"flex items-center gap-1",children:[n.jsx(v.Z,{className:"h-3 w-3"}),"App Mode"]}),"installable"===s&&(0,n.jsxs)(p.C,{variant:"outline",className:"flex items-center gap-1",children:[n.jsx(N.Z,{className:"h-3 w-3"}),"Installable"]})]})}const L=s(42362);let H={SIZE_LIMITS:{SCHOOLS:500,SESSIONS:1e3,LOCATION_DATA:100}},z={SCHOOLS:"schools_cache",SESSIONS:"sessions_cache",USER_DATA:"user_data_cache",LOCATION_DATA:"location_cache",CACHE_METADATA:"cache_metadata",PENDING_ACTIONS:"pending_actions"},Z=null;async function F(){return Z||(Z=await (0,b.X3)("schools-in-cache",2,{upgrade(e,t){if(!e.objectStoreNames.contains(z.SCHOOLS)){const t=e.createObjectStore(z.SCHOOLS,{keyPath:"id"});t.createIndex("name","name"),t.createIndex("region","region"),t.createIndex("assignedProviders","assignedProviders",{multiEntry:!0})}if(!e.objectStoreNames.contains(z.SESSIONS)){const t=e.createObjectStore(z.SESSIONS,{keyPath:"id"});t.createIndex("userId","userId"),t.createIndex("schoolId","schoolId"),t.createIndex("startTime","startTime"),t.createIndex("status","status")}if(!e.objectStoreNames.contains(z.USER_DATA)){const t=e.createObjectStore(z.USER_DATA,{keyPath:"id"});t.createIndex("role","role"),t.createIndex("lastActive","lastActive")}if(!e.objectStoreNames.contains(z.LOCATION_DATA)){const t=e.createObjectStore(z.LOCATION_DATA,{keyPath:"id"});t.createIndex("timestamp","timestamp"),t.createIndex("accuracy","accuracy")}if(!e.objectStoreNames.contains(z.CACHE_METADATA)){const t=e.createObjectStore(z.CACHE_METADATA,{keyPath:"id"});t.createIndex("expiresAt","expiresAt"),t.createIndex("lastAccessed","lastAccessed"),t.createIndex("accessCount","accessCount")}if(!e.objectStoreNames.contains(z.PENDING_ACTIONS)){const t=e.createObjectStore(z.PENDING_ACTIONS,{keyPath:"id",autoIncrement:!0});t.createIndex("timestamp","timestamp"),t.createIndex("type","type"),t.createIndex("priority","priority")}}}))}const B={CHECK_IN:"check_in",CHECK_OUT:"check_out",SESSION_UPDATE:"session_update",LOCATION_UPDATE:"location_update"},G={PENDING:"pending",SYNCING:"syncing",SYNCED:"synced",FAILED:"failed",CANCELLED:"cancelled"},$={BATCH_SIZE:10};async function q(e){try{let t=await F(),s=(await t.getAll(z.PENDING_ACTIONS)).filter(e=>e.status===G.PENDING||e.status===G.FAILED);return e&&(s=s.filter(t=>t.userId===e)),s.sort((e,t)=>e.timestamp-t.timestamp),s}catch(e){return console.error("Failed to get pending actions:",e),[]}}async function K(e,t,s){try{const n=await F(),a=await n.get(z.PENDING_ACTIONS,e);a&&(a.status=t,a._cachedAt=Date.now(),t===G.FAILED&&s&&(a.errorMessage=s,a.retryCount+=1),t===G.SYNCED&&(a.syncedAt=Date.now()),await n.put(z.PENDING_ACTIONS,a))}catch(e){console.error("Failed to update action status:",e)}}async function W(){try{let e=await F(),t=await e.getAll(z.PENDING_ACTIONS),s=0,n=Date.now();for(const a of t)(a.status===G.SYNCED||a.status===G.CANCELLED||a._expiresAt&&a._expiresAt<n||a.retryCount>=a.maxRetries&&a.status===G.FAILED)&&(await e.delete(z.PENDING_ACTIONS,a.id),s++);return s>0&&console.log(`Removed ${s} completed actions from queue`),s}catch(e){return console.error("Failed to remove completed actions:",e),0}}async function Y(){try{const e=await q();if(0===e.length)return{processed:0,synced:0,failed:0};console.log(`Processing ${e.length} pending actions`);let t=0,s=0,n=0,a=function(e,t){const s=[];for(let n=0;n<e.length;n+=t)s.push(e.slice(n,n+t));return s}(e,$.BATCH_SIZE);for(const e of a)(await Promise.allSettled(e.map(e=>Q(e)))).forEach((a,r)=>{n++,"fulfilled"===a.status&&a.value?t++:(s++,console.error(`Failed to process action ${e[r].id}:`,"rejected"===a.status?a.reason:"Unknown error"))}),a.length>1&&await new Promise(e=>setTimeout(e,500));return await W(),console.log(`Queue processing complete: ${t} synced, ${s} failed`),{processed:n,synced:t,failed:s}}catch(e){return console.error("Failed to process queue:",e),{processed:0,synced:0,failed:0}}}async function Q(e){try{await K(e.id,G.SYNCING);let t=!1;switch(e.type){case B.CHECK_IN:t=await J(e);break;case B.CHECK_OUT:t=await V(e);break;case B.SESSION_UPDATE:t=await X(e);break;case B.LOCATION_UPDATE:t=await ee(e);break;default:console.warn(`Unknown action type: ${e.type}`),t=!1}return t?await K(e.id,G.SYNCED):await K(e.id,G.FAILED,"Sync operation failed"),t}catch(s){console.error(`Error processing action ${e.id}:`,s);const t=s instanceof Error?s.message:"Unknown error";return await K(e.id,G.FAILED,t),!1}}async function J(e){try{const t=await fetch("/api/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e.payload,queuedActionId:e.id,originalTimestamp:e.timestamp})});if(!t.ok)throw Error(`HTTP ${t.status}: ${t.statusText}`);const s=await t.json();return console.log("Check-in synced successfully:",s),!0}catch(e){return console.error("Failed to sync check-in:",e),!1}}async function V(e){try{const t=await fetch("/api/sessions",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e.payload,queuedActionId:e.id,originalTimestamp:e.timestamp})});if(!t.ok)throw Error(`HTTP ${t.status}: ${t.statusText}`);const s=await t.json();return console.log("Check-out synced successfully:",s),!0}catch(e){return console.error("Failed to sync check-out:",e),!1}}async function X(e){try{const t=await fetch(`/api/sessions/${e.sessionId}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e.payload,queuedActionId:e.id,originalTimestamp:e.timestamp})});if(!t.ok)throw Error(`HTTP ${t.status}: ${t.statusText}`);const s=await t.json();return console.log("Session update synced successfully:",s),!0}catch(e){return console.error("Failed to sync session update:",e),!1}}async function ee(e){try{const t=await fetch("/api/locations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e.payload,queuedActionId:e.id,originalTimestamp:e.timestamp})});if(!t.ok)throw Error(`HTTP ${t.status}: ${t.statusText}`);const s=await t.json();return console.log("Location update synced successfully:",s),!0}catch(e){return console.error("Failed to sync location update:",e),!1}}const et={CHECK_IN:"high",CHECK_OUT:"critical",SESSION_UPDATE:"medium",LOCATION_UPDATE:"low"};class es{constructor(e={}){this.isSyncing=!1,this.syncHistory=[],this.config={enableAdaptiveSync:!0,enablePrioritySync:!0,enableBatchOptimization:!0,enableRetryOptimization:!0,maxConcurrentSyncs:3,syncTimeoutMs:3e4,priorityThresholdMs:3e5,debugMode:!1,...e}}async sync(e,t=!1){if(this.isSyncing&&!t)return this.config.debugMode&&console.log("Sync already in progress, skipping"),this.createSkippedResult("Already syncing");this.isSyncing=!0,this.lastNetworkStatus=e;const s=Date.now();try{const n=this.determineSyncStrategy(e);if(!n.shouldSync&&!t)return this.config.debugMode&&console.log("Sync skipped due to poor network conditions"),this.createSkippedResult("Poor network conditions");this.config.debugMode&&console.log(`Starting sync with strategy: ${n.name}`,n);const a=await q();if(0===a.length)return this.createSuccessResult(0,0,0,0,Date.now()-s,e.connectivityScore,n.name);const r=this.config.enablePrioritySync?this.prioritizeActions(a):a,i=await this.executeSyncStrategy(r,n,e);return this.recordSyncResult(i),await W(),this.config.debugMode&&console.log("Sync completed:",i),i}catch(a){const t=a instanceof Error?a.message:"Unknown sync error";console.error("Sync failed:",a);const n=this.createFailureResult(t,Date.now()-s,e.connectivityScore);return this.recordSyncResult(n),n}finally{this.isSyncing=!1}}determineSyncStrategy(e){const{connectivityScore:t,effectiveType:s,downlink:n,rtt:a,saveData:r}=e;return!e.isConnected||t<20?{name:"no-sync",batchSize:0,concurrency:0,timeout:0,shouldSync:!1,priority:"low"}:t>=80&&n>=5&&a<=50?{name:"aggressive",batchSize:2*$.BATCH_SIZE,concurrency:this.config.maxConcurrentSyncs,timeout:this.config.syncTimeoutMs,shouldSync:!0,priority:"high"}:t>=60&&n>=2&&a<=100?{name:"normal",batchSize:$.BATCH_SIZE,concurrency:Math.max(2,this.config.maxConcurrentSyncs-1),timeout:this.config.syncTimeoutMs,shouldSync:!0,priority:"medium"}:t>=40?{name:"conservative",batchSize:Math.max(3,Math.floor($.BATCH_SIZE/2)),concurrency:1,timeout:1.5*this.config.syncTimeoutMs,shouldSync:!0,priority:"medium"}:t>=20||r?{name:"minimal",batchSize:2,concurrency:1,timeout:2*this.config.syncTimeoutMs,shouldSync:!0,priority:"critical"}:{name:"fallback-no-sync",batchSize:0,concurrency:0,timeout:0,shouldSync:!1,priority:"low"}}prioritizeActions(e){const t=Date.now();return e.sort((e,s)=>{const n=et[e.type]||"low",a=et[s.type]||"low",r={critical:4,high:3,medium:2,low:1},i=r[a]-r[n];if(0!==i)return i;const c=t-e.timestamp,o=t-s.timestamp,l=c>this.config.priorityThresholdMs,d=o>this.config.priorityThresholdMs;if(l&&!d)return -1;if(d&&!l)return 1;const u=e.retryCount-s.retryCount;return 0!==u?u:e.timestamp-s.timestamp})}async executeSyncStrategy(e,t,s){let n=Date.now(),a=0,r=0,i=0,c=0,o=[],l=e;"critical"===t.priority&&(l=e.filter(e=>{const t=et[e.type];return"critical"===t||"high"===t}));const d=this.chunkArray(l,t.batchSize);for(const e of d){const n=e.slice(0,t.concurrency).map(async e=>{try{a++,await K(e.id,G.SYNCING);const s=new Promise((e,s)=>{setTimeout(()=>s(Error("Sync timeout")),t.timeout)}),n=this.syncSingleAction(e);if(await Promise.race([n,s]))r++,await K(e.id,G.SYNCED);else throw Error("Sync failed")}catch(n){i++;const t=n instanceof Error?n.message:"Unknown error",s=e.retryCount<e.maxRetries;o.push({actionId:e.id,error:t,willRetry:s}),s?await K(e.id,G.PENDING):await K(e.id,G.FAILED)}});await Promise.allSettled(n),d.length>1&&s.connectivityScore<50&&await this.delay(1e3*(d.length-1))}c=e.length-l.length;const u=Date.now()-n;return this.createSuccessResult(a,r,i,c,u,s.connectivityScore,t.name,o)}async syncSingleAction(e){try{return(await Y()).synced>0}catch(e){return!1}}getSyncRecommendations(e){const t=this.determineSyncStrategy(e),s=this.getLastKnownPendingCount(),n=this.estimateSyncDuration(s,t);if(!t.shouldSync){const s=this.calculateOptimalRetryDelay(e);return{shouldSync:!1,strategy:t.name,reason:`Network conditions not suitable (score: ${e.connectivityScore})`,estimatedDuration:0,recommendedDelay:s}}return{shouldSync:!0,strategy:t.name,reason:`Good conditions for ${t.name} sync (score: ${e.connectivityScore})`,estimatedDuration:n}}getSyncHistory(){return[...this.syncHistory].sort((e,t)=>t.timestamp-e.timestamp)}getSyncStatistics(){if(0===this.syncHistory.length)return{totalSyncs:0,successRate:0,averageDuration:0,averageNetworkScore:0,strategyCounts:{}};const e=this.syncHistory.length,t=this.syncHistory.filter(e=>e.result.success).length,s=this.syncHistory.reduce((e,t)=>e+t.result.duration,0)/e,n=this.syncHistory.reduce((e,t)=>e+t.result.networkScore,0)/e,a={};return this.syncHistory.forEach(e=>{a[e.result.strategy]=(a[e.result.strategy]||0)+1}),{totalSyncs:e,successRate:t/e*100,averageDuration:s,averageNetworkScore:n,strategyCounts:a}}recordSyncResult(e){this.syncHistory.push({timestamp:Date.now(),result:e}),this.syncHistory.length>100&&(this.syncHistory=this.syncHistory.slice(-100))}getLastKnownPendingCount(){return 5}estimateSyncDuration(e,t){return 0===e?0:Math.max(1e3,Math.min(6e4,1e3*e*(this.lastNetworkStatus?.connectivityScore?100/this.lastNetworkStatus.connectivityScore:2)/t.concurrency))}calculateOptimalRetryDelay(e){return 3e4*(1+(100-e.connectivityScore)/100*2)}createSuccessResult(e,t,s,n,a,r,i,c=[]){return{success:0===s||t>0,processed:e,synced:t,failed:s,skipped:n,duration:a,networkScore:r,strategy:i,errors:c}}createFailureResult(e,t,s){return{success:!1,processed:0,synced:0,failed:1,skipped:0,duration:t,networkScore:s,strategy:"failed",errors:[{actionId:"unknown",error:e,willRetry:!1}]}}createSkippedResult(e){return{success:!0,processed:0,synced:0,failed:0,skipped:1,duration:0,networkScore:this.lastNetworkStatus?.connectivityScore||0,strategy:"skipped",errors:[]}}chunkArray(e,t){const s=[];for(let n=0;n<e.length;n+=t)s.push(e.slice(n,n+t));return s}delay(e){return new Promise(t=>setTimeout(t,e))}}const en=new es({enableAdaptiveSync:!0,enablePrioritySync:!0,enableBatchOptimization:!0,enableRetryOptimization:!0,debugMode:!1}),ea={},er={enableAutoSync:!0,enableGradualSync:!0,stabilityWaitMs:2e3,maxSyncAttempts:3,syncRetryDelayMs:5e3,enableSyncNotifications:!0,debugMode:!1};function ei(e={}){let{autoRefreshInterval:t=5e3,enableDebugLogs:s=!1}=e,n=(0,L.k)(),a=function(e={}){const t=(0,L.k)(),[s,n]=(0,d.useState)({...er,...e}),[a,r]=(0,d.useState)(!1),[i,c]=(0,d.useState)([]),[o,l]=(0,d.useState)(),u=(0,d.useRef)(),m=(0,d.useRef)(null);(0,d.useRef)(!1),(0,d.useRef)(0);const h=(0,d.useCallback)(async(e,n=!1)=>{if(a&&!n)throw s.debugMode&&console.log("Restoration already in progress, skipping"),Error("Restoration already in progress");r(!0);const i=Date.now(),o={timestamp:i,triggerReason:e,networkScore:t.connectivityScore,stabilityWaitTime:0,syncAttempts:0,syncResults:[],totalDuration:0,success:!1};try{s.debugMode&&(console.log(`Starting connectivity restoration: ${e}`),console.log("Network status:",t)),s.enableGradualSync&&t.isUnstable&&(s.debugMode&&console.log(`Waiting ${s.stabilityWaitMs}ms for connection stability`),o.stabilityWaitTime=s.stabilityWaitMs,await new Promise(e=>{u.current=setTimeout(e,s.stabilityWaitMs)}));const a=en.getSyncRecommendations(t);if(!a.shouldSync&&!n)throw s.debugMode&&console.log("Sync not recommended after stability wait:",a.reason),a.recommendedDelay&&setTimeout(()=>{t.isOnline&&h("delayed-retry").catch(console.error)},a.recommendedDelay),Error(`Sync not recommended: ${a.reason}`);let r=null,d=0;for(;d<s.maxSyncAttempts;){d++,o.syncAttempts=d,s.debugMode&&console.log(`Sync attempt ${d}/${s.maxSyncAttempts}`);try{const e=await en.sync(t,n);if(o.syncResults.push(e),r=e,e.success&&e.synced>0){o.success=!0,s.debugMode&&console.log("Sync successful:",e);break}if(e.success&&0===e.synced){o.success=!0,s.debugMode&&console.log("No actions to sync");break}if(s.debugMode&&console.log("Sync failed:",e),d<s.maxSyncAttempts){const e=s.syncRetryDelayMs*Math.pow(2,d-1);if(s.debugMode&&console.log(`Waiting ${e}ms before retry`),await new Promise(t=>setTimeout(t,e)),!t.isOnline)throw Error("Connection lost during retry wait")}}catch(a){const e=a instanceof Error?a.message:"Unknown sync error";s.debugMode&&console.error(`Sync attempt ${d} failed:`,a);const n={success:!1,processed:0,synced:0,failed:1,skipped:0,duration:1e3,networkScore:t.connectivityScore,strategy:"error",errors:[{actionId:"unknown",error:e,willRetry:d<s.maxSyncAttempts}]};o.syncResults.push(n),r=n,d<s.maxSyncAttempts&&await new Promise(e=>setTimeout(e,s.syncRetryDelayMs))}}return o.totalDuration=Date.now()-i,s.debugMode&&console.log("Restoration completed:",o),l(o),c(e=>[...e,o].slice(-50)),s.enableSyncNotifications&&o.success&&function(e){if("Notification"in window&&"granted"===Notification.permission){const t=e.syncResults.reduce((e,t)=>e+t.synced,0);t>0&&new Notification("Sync Completed",{body:`Successfully synced ${t} pending actions`,icon:"/icons/sync-icon.png",tag:"sync-completion"})}}(o),r||o.syncResults[o.syncResults.length-1]}catch(e){throw e instanceof Error&&e.message,s.debugMode&&console.error("Restoration failed:",e),o.totalDuration=Date.now()-i,o.success=!1,l(o),c(e=>[...e,o].slice(-50)),e}finally{r(!1),u.current&&(clearTimeout(u.current),u.current=void 0),m.current=null}},[s,t,a]),y=(0,d.useCallback)(async(e="manual")=>h(e,!0),[h]),f=(0,d.useCallback)(()=>{m.current&&m.current(),u.current&&(clearTimeout(u.current),u.current=void 0),r(!1)},[]),g=(0,d.useCallback)(e=>{n(t=>({...t,...e}))},[]),p=(0,d.useCallback)(()=>{if(0===i.length)return{totalRestorations:0,successRate:0,averageDuration:0,averageSyncAttempts:0};const e=i.length,t=i.filter(e=>e.success).length,s=i.reduce((e,t)=>e+t.totalDuration,0)/e,n=i.reduce((e,t)=>e+t.syncAttempts,0)/e;return{totalRestorations:e,successRate:t/e*100,averageDuration:s,averageSyncAttempts:n}},[i]);return{isRestoring:a,lastRestoration:o,restorationHistory:i,triggerSync:y,cancelSync:f,updateConfig:g,getRestorationStats:p}}(e.restorationConfig),[r,i]=(0,d.useState)({total:0,pending:0,syncing:0,synced:0,failed:0,cancelled:0}),[c,o]=(0,d.useState)([]),[l,u]=(0,d.useState)(!1),[m,h]=(0,d.useState)(),[y,f]=(0,d.useState)(),[g,p]=(0,d.useState)({shouldSync:!1,reason:"No network status available"});(0,d.useRef)(),(0,d.useRef)(null);const x=(0,d.useCallback)(async(e,t,n)=>{try{f(void 0);const a=await ea.checkIn(e,t,n);return s&&console.log("Check-in result:",a),a}catch(e){return f(e instanceof Error?e.message:"Check-in failed"),console.error("Check-in error:",e),{success:!1}}},[s]),S=(0,d.useCallback)(async(e,t,n)=>{try{f(void 0);const a=await ea.checkOut(e,t,n);return s&&console.log("Check-out result:",a),a}catch(e){return f(e instanceof Error?e.message:"Check-out failed"),console.error("Check-out error:",e),{success:!1}}},[s]),w=(0,d.useCallback)(async(e=!1)=>{if(l&&!e)return null;try{u(!0),f(void 0);const t=await ea.syncNow(e);if(t){const e={success:t.synced>0||0===t.processed,processed:t.processed,synced:t.synced,failed:t.failed,skipped:0,duration:0,networkScore:t.networkScore||n.connectivityScore,strategy:t.strategy||"basic",errors:[]};return h(e),s&&console.log("Manual sync result:",e),e}return null}catch(e){return f(e instanceof Error?e.message:"Sync failed"),console.error("Sync error:",e),null}finally{u(!1)}},[l,n.connectivityScore,s]),v=(0,d.useCallback)(async(e="manual")=>{try{f(void 0);const t=await a.triggerSync(e);return h(t),s&&console.log("Connectivity restoration result:",t),t}catch(e){throw f(e instanceof Error?e.message:"Restoration failed"),console.error("Restoration error:",e),e}},[a,s]),N=(0,d.useCallback)(async e=>{try{const t=await ea.getPendingActions(e);return o(t),t}catch(e){return console.error("Failed to get pending actions:",e),[]}},[]),b=(0,d.useCallback)(async()=>{try{const e=await ea.getStats();i(e)}catch(e){console.error("Failed to refresh stats:",e)}},[]),j=(0,d.useCallback)(e=>{a.updateConfig(e)},[a]);return{state:{queueStats:r,pendingActions:c,isSyncing:l||a.isRestoring,lastSyncResult:m,syncError:y,isOnline:n.isOnline,isUnstable:n.isUnstable,connectivityScore:n.connectivityScore,isRestoring:a.isRestoring,syncRecommendations:g},actions:{checkIn:x,checkOut:S,syncNow:w,triggerRestoration:v,getPendingActions:N,refreshStats:b,updateRestorationConfig:j}}}const ec=s(78992),eo=s(81549),el=s(8206),ed=s(73521);const eu=eo.zt,em=d.forwardRef(({className:e,...t},s)=>n.jsx(eo.l_,{ref:s,className:(0,ed.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));em.displayName=eo.l_.displayName;const eh=(0,el.j)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),ey=d.forwardRef(({className:e,variant:t,...s},a)=>n.jsx(eo.fC,{ref:a,className:(0,ed.cn)(eh({variant:t}),e),...s}));ey.displayName=eo.fC.displayName,d.forwardRef(({className:e,...t},s)=>n.jsx(eo.aU,{ref:s,className:(0,ed.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t})).displayName=eo.aU.displayName;const ef=d.forwardRef(({className:e,...t},s)=>n.jsx(eo.x8,{ref:s,className:(0,ed.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:n.jsx(h.Z,{className:"h-4 w-4"})}));ef.displayName=eo.x8.displayName;const eg=d.forwardRef(({className:e,...t},s)=>n.jsx(eo.Dx,{ref:s,className:(0,ed.cn)("text-sm font-semibold",e),...t}));eg.displayName=eo.Dx.displayName;const ep=d.forwardRef(({className:e,...t},s)=>n.jsx(eo.dk,{ref:s,className:(0,ed.cn)("text-sm opacity-90",e),...t}));ep.displayName=eo.dk.displayName;let ex=0,eS=new Map,ew=e=>{if(eS.has(e))return;const t=setTimeout(()=>{eS.delete(e),ej({type:"REMOVE_TOAST",toastId:e})},1e6);eS.set(e,t)},ev=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{const{toastId:s}=t;return s?ew(s):e.toasts.forEach(e=>{ew(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},eN=[],eb={toasts:[]};function ej(e){eb=ev(eb,e),eN.forEach(e=>{e(eb)})}function eA({...e}){const t=(ex=(ex+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>ej({type:"DISMISS_TOAST",toastId:t});return ej({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||s()}}}),{id:t,dismiss:s,update:e=>ej({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function eC(){const[e,t]=d.useState(eb);return d.useEffect(()=>(eN.push(t),()=>{const e=eN.indexOf(t);e>-1&&eN.splice(e,1)}),[e]),{...e,toast:eA,dismiss:e=>ej({type:"DISMISS_TOAST",toastId:e})}}const ek=s(42974),eI=s(17570),eO=s(31787);function eE({children:e,maxMessages:t=5,enableToasts:s=!0,enableNotifications:a=!1}){const r=(0,L.k)(),{state:i,actions:c}=ei(),{toast:o}=eC(),[l,u]=(0,d.useState)([]),[m,h]=(0,d.useState)(r.isOnline),[y,f]=(0,d.useState)(i.queueStats.pending);return(0,n.jsxs)(eu,{children:[e,n.jsx(em,{})]})}function eT({className:e,maxVisible:t=3}){const s=(0,L.k)(),{state:a,actions:r}=ei(),c=(()=>{const e=[];return s.isOnline||e.push({id:"offline-status",type:"warning",title:"Working Offline",description:`You can continue working. ${a.queueStats.pending} actions will sync when connected.`,timestamp:Date.now()}),s.isOnline&&s.isUnstable&&e.push({id:"unstable-connection",type:"warning",title:"Unstable Connection",description:"Some features may be limited due to poor connectivity.",timestamp:Date.now()}),a.queueStats.pending>0&&s.isOnline&&e.push({id:"pending-sync",type:"info",title:"Syncing Actions",description:`${a.queueStats.pending} actions waiting to sync`,action:{label:"Sync Now",handler:()=>r.syncNow(!0)},timestamp:Date.now()}),a.queueStats.failed>0&&e.push({id:"failed-actions",type:"error",title:"Sync Failed",description:`${a.queueStats.failed} actions failed to sync`,action:{label:"Retry",handler:()=>r.syncNow(!0)},timestamp:Date.now()}),!a.syncRecommendations.shouldSync&&a.queueStats.pending>0&&e.push({id:"sync-delayed",type:"info",title:"Sync Delayed",description:a.syncRecommendations.reason,timestamp:Date.now()}),e.slice(0,t)})();if(0===c.length)return null;const o=e=>{switch(e){case"success":return n.jsx(ek.Z,{className:"h-4 w-4"});case"warning":return n.jsx(eI.Z,{className:"h-4 w-4"});case"error":return n.jsx(h.Z,{className:"h-4 w-4"});default:return n.jsx(eO.Z,{className:"h-4 w-4"})}},l=e=>"error"===e?"destructive":"default";return n.jsx("div",{className:e,children:c.map(e=>(0,n.jsxs)(ec.bZ,{variant:l(e.type),className:"mb-2",children:[o(e.type),n.jsx(ec.X,{children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[n.jsx("div",{className:"font-medium",children:e.title}),n.jsx("div",{className:"text-sm",children:e.description})]}),e.action&&n.jsx(i.z,{size:"sm",variant:"outline",onClick:e.action.handler,className:"ml-4",children:e.action.label})]})})]},e.id))})}const e_=s(23968);function eD({variant:e="compact",showSyncButton:t=!0,showQueueInfo:s=!0,className:a}){const r=(0,L.k)(),{state:c,actions:o}=ei({enableDebugLogs:!1}),l=()=>r.isOnline?r.isUnstable?n.jsx(eI.Z,{className:"h-4 w-4"}):n.jsx(x.Z,{className:"h-4 w-4"}):n.jsx(S.Z,{className:"h-4 w-4"}),d=()=>r.isOnline?r.isUnstable?"text-yellow-600":r.connectivityScore>=80?"text-green-600":r.connectivityScore>=60?"text-blue-600":"text-gray-600":"text-red-600",u=async()=>{try{await o.syncNow(!0)}catch(e){console.error("Manual sync failed:",e)}};return"compact"===e?(0,n.jsxs)("div",{className:(0,ed.cn)("flex items-center gap-1",a),children:[n.jsx("div",{className:(0,ed.cn)("flex items-center",d()),children:l()}),c.queueStats.pending>0&&n.jsx(p.C,{variant:"secondary",className:"text-xs",children:c.queueStats.pending})]}):"banner"===e?r.isOnline&&!r.isUnstable&&0===c.queueStats.pending?null:n.jsx(ec.bZ,{className:(0,ed.cn)("mb-4",a),children:(0,n.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:d(),children:l()}),n.jsx("div",{children:n.jsx(ec.X,{className:"m-0",children:r.isOnline?r.isUnstable?(0,n.jsxs)(n.Fragment,{children:[n.jsx("span",{className:"font-medium",children:"Connection unstable"}),n.jsx("span",{className:"ml-2",children:"• Some features may be limited"})]}):c.queueStats.pending>0?(0,n.jsxs)(n.Fragment,{children:[n.jsx("span",{className:"font-medium",children:"Syncing pending actions"}),(0,n.jsxs)("span",{className:"ml-2",children:["• ",c.queueStats.pending," remaining"]})]}):null:(0,n.jsxs)(n.Fragment,{children:[n.jsx("span",{className:"font-medium",children:"Working offline"}),c.queueStats.pending>0&&(0,n.jsxs)("span",{className:"ml-2",children:["• ",c.queueStats.pending," actions will sync when connected"]})]})})})]}),t&&c.queueStats.pending>0&&r.isOnline&&(0,n.jsxs)(i.z,{size:"sm",variant:"outline",onClick:u,disabled:c.isSyncing,className:"ml-4",children:[c.isSyncing?n.jsx(f.Z,{className:"h-3 w-3 animate-spin mr-1"}):n.jsx(f.Z,{className:"h-3 w-3 mr-1"}),"Sync Now"]})]})}):(0,n.jsxs)("div",{className:(0,ed.cn)("space-y-3",a),children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:(0,ed.cn)("flex items-center",d()),children:l()}),(0,n.jsxs)("div",{children:[n.jsx("div",{className:"font-medium",children:r.isOnline?"Online":"Offline"}),(0,n.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Connection: ",r.isOnline?r.isUnstable?"Unstable":r.connectivityScore>=80?"Excellent":r.connectivityScore>=60?"Good":r.connectivityScore>=40?"Fair":"Poor":"Offline"]})]})]}),r.isOnline&&(0,n.jsxs)("div",{className:"text-right",children:[(0,n.jsxs)("div",{className:"text-sm font-medium",children:[r.connectivityScore,"/100"]}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Quality Score"})]})]}),r.isOnline&&(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsxs)("div",{className:"flex justify-between text-xs",children:[n.jsx("span",{className:"text-muted-foreground",children:"Connection Quality"}),(0,n.jsxs)("span",{className:"text-muted-foreground",children:[r.connectivityScore,"%"]})]}),n.jsx(e_.E,{value:r.connectivityScore,className:"h-2"})]}),s&&(0,n.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"flex items-center text-blue-600",children:c.isSyncing?n.jsx(f.Z,{className:"h-4 w-4 animate-spin"}):c.queueStats.pending>0?n.jsx(w.Z,{className:"h-4 w-4"}):n.jsx(ek.Z,{className:"h-4 w-4 text-green-600"})}),(0,n.jsxs)("div",{children:[n.jsx("div",{className:"font-medium",children:"Queue Status"}),n.jsx("div",{className:"text-sm text-muted-foreground",children:(()=>{const{queueStats:e}=c;return e.pending>0?`${e.pending} pending actions`:e.syncing>0?`${e.syncing} syncing`:e.failed>0?`${e.failed} failed`:"All synced"})()})]})]}),t&&c.queueStats.pending>0&&r.isOnline&&(0,n.jsxs)(i.z,{size:"sm",variant:"outline",onClick:u,disabled:c.isSyncing,children:[c.isSyncing?n.jsx(f.Z,{className:"h-3 w-3 animate-spin mr-1"}):n.jsx(f.Z,{className:"h-3 w-3 mr-1"}),"Sync"]})]}),!c.syncRecommendations.shouldSync&&c.queueStats.pending>0&&(0,n.jsxs)(ec.bZ,{children:[n.jsx(eO.Z,{className:"h-4 w-4"}),(0,n.jsxs)(ec.X,{children:[n.jsx("strong",{children:"Sync delayed:"})," ",c.syncRecommendations.reason,c.syncRecommendations.recommendedDelay&&(0,n.jsxs)("span",{className:"ml-1",children:["(Recommended wait:"," ",Math.round(c.syncRecommendations.recommendedDelay/1e3),"s)"]})]})]}),!r.isOnline&&(0,n.jsxs)(ec.bZ,{children:[n.jsx(eO.Z,{className:"h-4 w-4"}),(0,n.jsxs)(ec.X,{children:[n.jsx("strong",{children:"Working offline:"})," You can still check in and out. Actions will sync automatically when connection returns."]})]})]})}function eP({variant:e="compact",position:t="top",showMessages:s=!0,className:a}){const r=(0,L.k)(),{state:i}=ei();return!r.isOnline||i.queueStats.pending>0||i.queueStats.failed>0||r.isUnstable||"full"===e?n.jsx("div",{className:(0,ed.cn)("w-full z-40","full"===e?"relative p-4 bg-background border-b":`sticky ${({top:"top-0",bottom:"bottom-0"})[t]} bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b px-4 py-2`,a),children:(()=>{switch(e){case"minimal":return(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[n.jsx(eD,{variant:"compact",className:"flex-shrink-0"}),(i.queueStats.pending>0||i.queueStats.failed>0)&&(0,n.jsxs)("div",{className:"text-xs text-muted-foreground ml-2",children:[i.queueStats.pending>0&&`${i.queueStats.pending} pending`,i.queueStats.pending>0&&i.queueStats.failed>0&&", ",i.queueStats.failed>0&&`${i.queueStats.failed} failed`]})]});case"compact":return(0,n.jsxs)("div",{className:"space-y-2",children:[n.jsx(eD,{variant:"banner",showSyncButton:!0,showQueueInfo:!1}),s&&n.jsx(eT,{maxVisible:1})]});case"full":return(0,n.jsxs)("div",{className:"space-y-3",children:[n.jsx(eD,{variant:"full",showSyncButton:!0,showQueueInfo:!0}),s&&n.jsx(eT,{maxVisible:3})]});default:return null}})()}):null}function eR(){const{toasts:e}=eC();return(0,n.jsxs)(eu,{children:[e.map(function({id:e,title:t,description:s,action:a,...r}){return(0,n.jsxs)(ey,{...r,children:[(0,n.jsxs)("div",{className:"grid gap-1",children:[t&&n.jsx(eg,{children:t}),s&&n.jsx(ep,{children:s})]}),a,n.jsx(ef,{})]},e)}),n.jsx(em,{})]})}const eM=s(43653);function eU({children:e}){return n.jsx(eE,{enableToasts:!0,enableNotifications:!0,children:(0,n.jsxs)("div",{className:"flex flex-col min-h-screen",children:[n.jsx(eL,{}),n.jsx(eP,{variant:"compact",position:"top"}),n.jsx(g,{}),(0,n.jsxs)("main",{id:"main-content",className:"flex-1 container-responsive py-4 sm:py-6 lg:py-8",tabIndex:-1,children:[n.jsx(y,{}),e]}),n.jsx(eR,{})]})})}function eL(){const{user:e}=(0,a.a)(),t=(0,o.useRouter)(),{trackLogout:s}=(0,r.z)(),d=async()=>{try{await (0,c.ni)(),s(),t.push("/")}catch(e){console.error("Sign out failed:",e)}};return n.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b",role:"banner",children:n.jsx("div",{className:"container-responsive py-3 sm:py-4",children:(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[n.jsx(l.default,{href:"/",className:"focus-ring","aria-label":"Schools-In Home",children:n.jsx(eM.m,{size:"sm",priority:!0})}),n.jsx("nav",{className:"flex items-center gap-2 sm:gap-4",role:"navigation","aria-label":"Main navigation",children:e&&(0,n.jsxs)(n.Fragment,{children:[n.jsx(eD,{variant:"compact",className:"hidden sm:flex"}),n.jsx("div",{className:"hidden md:flex",children:n.jsx(U,{})}),n.jsx(l.default,{href:"/profile",className:"touch-target text-sm sm:text-base text-foreground/80 hover:text-foreground transition-colors focus-ring","aria-label":"User profile",children:"Profile"}),(0,n.jsxs)(i.z,{variant:"outline",onClick:d,className:"touch-target text-sm sm:text-base focus-ring",size:"sm","aria-label":"Sign out of application",children:[n.jsx("span",{className:"hidden sm:inline",children:"Sign Out"}),n.jsx("span",{className:"sm:hidden",children:"Out"})]})]})})]})})})}},73940:(e,t,s)=>{"use strict";s.d(t,{AuthProvider:()=>i});const n=s(28002),a=s(96800);const r=(0,s(22488).createContext)({user:null,loading:!0});function i({children:e}){const t=(0,a.a)();return n.jsx(r.Provider,{value:t,children:e})}},78992:(e,t,s)=>{"use strict";s.d(t,{Cd:()=>l,X:()=>d,bZ:()=>o});const n=s(28002),a=s(22488),r=s(8206),i=s(73521);const c=(0,r.j)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=a.forwardRef(({className:e,variant:t,...s},a)=>n.jsx("div",{ref:a,role:"alert",className:(0,i.cn)(c({variant:t}),e),...s}));o.displayName="Alert";const l=a.forwardRef(({className:e,...t},s)=>n.jsx("h5",{ref:s,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",e),...t}));l.displayName="AlertTitle";const d=a.forwardRef(({className:e,...t},s)=>n.jsx("div",{ref:s,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",e),...t}));d.displayName="AlertDescription"},78620:(e,t,s)=>{"use strict";s.d(t,{C:()=>c});const n=s(28002);s(22488);const a=s(8206),r=s(73521);const i=(0,a.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function c({className:e,variant:t,...s}){return n.jsx("div",{className:(0,r.cn)(i({variant:t}),e),...s})}},34687:(e,t,s)=>{"use strict";s.d(t,{z:()=>l});const n=s(28002),a=s(22488),r=s(62001),i=s(8206),c=s(73521);const o=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-primary focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=a.forwardRef(({className:e,variant:t,size:s,asChild:a=!1,...i},l)=>{const d=a?r.g7:"button";return n.jsx(d,{className:(0,c.cn)(o({variant:t,size:s,className:e})),ref:l,...i})});l.displayName="Button"},16885:(e,t,s)=>{"use strict";s.d(t,{Ol:()=>c,SZ:()=>l,Zb:()=>i,aY:()=>d,ll:()=>o});const n=s(28002),a=s(22488),r=s(73521);const i=a.forwardRef(({className:e,...t},s)=>n.jsx("div",{ref:s,className:(0,r.cn)("rounded-xl border bg-card text-card-foreground shadow",e),...t}));i.displayName="Card";const c=a.forwardRef(({className:e,...t},s)=>n.jsx("div",{ref:s,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",e),...t}));c.displayName="CardHeader";const o=a.forwardRef(({className:e,...t},s)=>n.jsx("div",{ref:s,className:(0,r.cn)("font-semibold leading-none tracking-tight",e),...t}));o.displayName="CardTitle";const l=a.forwardRef(({className:e,...t},s)=>n.jsx("div",{ref:s,className:(0,r.cn)("text-sm text-muted-foreground",e),...t}));l.displayName="CardDescription";const d=a.forwardRef(({className:e,...t},s)=>n.jsx("div",{ref:s,className:(0,r.cn)("p-6 pt-0",e),...t}));d.displayName="CardContent",a.forwardRef(({className:e,...t},s)=>n.jsx("div",{ref:s,className:(0,r.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter"},43653:(e,t,s)=>{"use strict";s.d(t,{T:()=>o,m:()=>c});const n=s(28002);s(22488);const a=s(73521),r=s(710);const i={sm:{width:32,height:32,textSize:"text-lg"},md:{width:48,height:48,textSize:"text-xl"},lg:{width:64,height:64,textSize:"text-2xl"},xl:{width:96,height:96,textSize:"text-3xl"}};function c({size:e="md",className:t,priority:s=!1,showText:c=!0}){const{width:o,height:l,textSize:d}=i[e];return(0,n.jsxs)("div",{className:(0,a.cn)("flex items-center gap-3",t),children:[n.jsx(r.OptimizedImage,{src:"/DMDL_logo.png",alt:"DMDL Schools-In Logo",width:o,height:l,priority:s,quality:90,className:"object-contain",loading:s?"eager":"lazy"}),c&&n.jsx("span",{className:(0,a.cn)("font-bold text-brand-primary",d),children:"Schools-In"})]})}function o({title:e,subtitle:t,className:s}){return(0,n.jsxs)("div",{className:(0,a.cn)("text-center space-y-4",s),children:[n.jsx(c,{size:"xl",className:"justify-center"}),e&&(0,n.jsxs)("div",{className:"space-y-2",children:[n.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-gray-900",children:e}),t&&n.jsx("p",{className:"text-muted-foreground text-sm sm:text-base",children:t})]})]})}},710:(e,t,s)=>{"use strict";s.d(t,{OptimizedImage:()=>o,X:()=>l});const n=s(28002),a=s(22488),r=s(28925),i=s(73521),c=s(37329);function o({src:e,alt:t,width:s,height:o,priority:l=!1,quality:d=75,placeholder:u="empty",blurDataURL:m,sizes:h,fill:y=!1,className:f,fallback:g,loading:p="lazy",onLoad:x,onError:S}){const[w,v]=(0,a.useState)(!1),[N,b]=(0,a.useState)(!1),j=(0,a.useCallback)(()=>{v(!0),x?.()},[x]),A=(0,a.useCallback)(()=>{b(!0),S?.()},[S]);return N&&g?n.jsx(n.Fragment,{children:g}):N?n.jsx("div",{className:(0,i.cn)("flex items-center justify-center bg-gray-100 text-gray-400",f),style:{width:y?"100%":s,height:y?"100%":o},children:n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}):(0,n.jsxs)("div",{className:(0,i.cn)("relative",f),children:[!w&&n.jsx("div",{className:"absolute inset-0 z-10",children:n.jsx(c.Od,{className:(0,i.cn)("w-full h-full",{"absolute inset-0":y}),style:{width:y?"100%":s,height:y?"100%":o}})}),n.jsx(r.default,{src:e,alt:t,width:y?void 0:s,height:y?void 0:o,fill:y,priority:l,quality:d,placeholder:u,blurDataURL:m,sizes:h,loading:p,className:(0,i.cn)("transition-opacity duration-200",w?"opacity-100":"opacity-0"),onLoad:j,onError:A})]})}function l({src:e,alt:t,size:s=40,className:a,fallback:r}){const c=n.jsx("div",{className:(0,i.cn)("rounded-full bg-gray-300 flex items-center justify-center text-gray-600",a),style:{width:s,height:s},children:n.jsx("svg",{className:"w-1/2 h-1/2",fill:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{d:"M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z"})})});return n.jsx(o,{src:e,alt:t,width:s,height:s,className:(0,i.cn)("rounded-full",a),quality:85,placeholder:"blur",blurDataURL:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAEDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAhEAACAQMDBQAAAAAAAAAAAAABAgMABAUGIWGRkqGx0f/EABUBAQEAAAAAAAAAAAAAAAAAAAMF/8QAGhEAAgIDAAAAAAAAAAAAAAAAAAECEgMRkf/aAAwDAQACEQMRAD8AltJagyeH0AthI5xdrLcNM91BF5pX2HaH9bcfaSXWGaRmknyLhxEDnGFELMO4==",fallback:r||c})}},23968:(e,t,s)=>{"use strict";s.d(t,{E:()=>c});const n=s(28002),a=s(22488),r=s(72618),i=s(73521);const c=a.forwardRef(({className:e,value:t,...s},a)=>n.jsx(r.fC,{ref:a,className:(0,i.cn)("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",e),...s,children:n.jsx(r.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));c.displayName=r.fC.displayName},37329:(e,t,s)=>{"use strict";s.d(t,{As:()=>c,Od:()=>r,eM:()=>o});const n=s(28002);s(22488);const a=s(73521);function r({className:e,...t}){return n.jsx("div",{className:(0,a.cn)("animate-pulse rounded-md bg-muted",e),...t})}function i({lines:e=1,className:t,...s}){return n.jsx("div",{className:(0,a.cn)("space-y-2",t),...s,children:Array.from({length:e}).map((t,s)=>n.jsx(r,{className:(0,a.cn)("h-4",s===e-1&&e>1?"w-3/4":"w-full")},s))})}function c({showImage:e=!0,className:t,...s}){return(0,n.jsxs)("div",{className:(0,a.cn)("card-brand space-y-4",t),...s,children:[e&&n.jsx(r,{className:"h-32 w-full rounded-lg"}),(0,n.jsxs)("div",{className:"space-y-3",children:[n.jsx(r,{className:"h-6 w-3/4"}),n.jsx(i,{lines:2}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[n.jsx(r,{className:"h-8 w-20"}),n.jsx(r,{className:"h-8 w-16"})]})]})]})}function o({items:e=5,showAvatar:t=!0,className:s,...i}){return n.jsx("div",{className:(0,a.cn)("space-y-4",s),...i,children:Array.from({length:e}).map((e,s)=>(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[t&&n.jsx(r,{className:"h-12 w-12 rounded-full"}),(0,n.jsxs)("div",{className:"flex-1 space-y-2",children:[n.jsx(r,{className:"h-4 w-3/4"}),n.jsx(r,{className:"h-3 w-1/2"})]}),n.jsx(r,{className:"h-8 w-20"})]},s))})}},82448:(e,t,s)=>{"use strict";s.d(t,{SkipToContent:()=>i,qg:()=>c,uy:()=>r});const n=s(28002),a=s(22488);function r({children:e,as:t="span",...s}){return n.jsx(t,{className:"sr-only",...s,children:e})}function i({targetId:e="main-content",className:t,children:s="Skip to main content"}){return n.jsx("a",{href:`#${e}`,className:`
        absolute left-[-9999px] top-auto w-1 h-1 overflow-hidden z-[999999]
        focus:fixed focus:top-4 focus:left-4 focus:w-auto focus:h-auto 
        focus:bg-brand-primary focus:text-white focus:px-4 focus:py-2 
        focus:rounded-md focus:no-underline focus:z-[999999]
        ${t||""}
      `,onClick:e=>{},children:s})}function c(){return{announce:a.useCallback((e,t="polite")=>{const s=document.getElementById("announcement-region");if(s){const n=document.createElement("div");for(n.textContent=e,n.setAttribute("role","log"),n.setAttribute("aria-live",t),n.setAttribute("aria-atomic","true");s.firstChild;)s.removeChild(s.firstChild);s.appendChild(n),setTimeout(()=>{s.contains(n)&&s.removeChild(n)},5e3)}},[])}}},56676:(e,t,s)=>{"use strict";s.d(t,{Ry:()=>i,ni:()=>l,o1:()=>c,qj:()=>o});const n=s(94018),a=s(41662);const r=new n.hJ,i=async(e,t)=>await (0,n.e5)(a.I8,e,t),c=async(e,t)=>await (0,n.Xb)(a.I8,e,t),o=async()=>await (0,n.rh)(a.I8,r),l=async()=>await (0,n.w7)(a.I8)},66204:(e,t,s)=>{"use strict";s.d(t,{Ul:()=>r,_N:()=>c,gU:()=>i});const n=s(61694),a=s(41662);const r={USERS:"users",SESSIONS:"sessions",LOCATIONS:"locations"},i=async(e,t,s)=>{await (0,n.r7)((0,n.JU)(a.db,e,t),s)},c=async e=>(await (0,n.PL)((0,n.hJ)(a.db,e))).docs.map(e=>({id:e.id,...e.data()}))},24004:(e,t,s)=>{"use strict";s.d(t,{dW:()=>a,iB:()=>r,vC:()=>i});const n=s(41662);const a={LOGIN:"login",LOGOUT:"logout",SIGNUP:"sign_up",SESSION_START:"session_start",SESSION_END:"session_end",SESSION_PAUSE:"session_pause",SESSION_RESUME:"session_resume",LOCATION_CHECK_IN:"location_check_in",LOCATION_CHECK_OUT:"location_check_out",LOCATION_VIEW:"location_view",SEARCH:"search",PAGE_VIEW:"page_view",ERROR:"error",CACHE_ERROR:"cache_error",NETWORK_ERROR:"network_error",PERFORMANCE_METRIC:"performance_metric",CACHE_HIT:"cache_hit",CACHE_MISS:"cache_miss"},r={CHECK_IN_DURATION:"check_in_duration",LOCATION_LOAD_TIME:"location_load_time",SESSION_LIST_LOAD:"session_list_load",USER_SEARCH_TIME:"user_search_time",CACHE_RESPONSE_TIME:"cache_response_time"};class i{static trackEvent(e,t={},s={}){}static trackPerformance(e,t,s={}){}static trackUserSession(e,t,s={}){const n={start:a.SESSION_START,end:a.SESSION_END,pause:a.SESSION_PAUSE,resume:a.SESSION_RESUME};this.trackEvent(n[t],{user_id:e,session_duration:s.duration,location_id:s.locationId,session_type:s.type||"check_in"},{user_role:s.userRole,total_sessions:s.totalSessions})}static trackLocationEvent(e,t,s={}){const n="check_in"===e?a.LOCATION_CHECK_IN:"check_out"===e?a.LOCATION_CHECK_OUT:a.LOCATION_VIEW;this.trackEvent(n,{location_id:t.locationId,location_name:t.locationName,accuracy:t.accuracy,distance_from_location:t.distance,gps_time:t.gpsTime},{user_role:s.role,provider_experience:s.experience})}static trackError(e,t={},s="medium"){if(n.Sv)try{const t=n.Sv.trace(`error_${s}`);t.putAttribute("error_type",e.name),t.putAttribute("error_message",e.message.substring(0,100)),t.stop()}catch(e){console.warn("Performance error tracking failed:",e)}}static trackCachePerformance(e,t={}){const s="hit"===e?a.CACHE_HIT:a.CACHE_MISS;this.trackEvent(s,{cache_operation:e,cache_type:t.cacheType,data_type:t.dataType,response_time:t.responseTime})}static trackSearch(e,t,s){this.trackEvent(a.SEARCH,{search_term:e.substring(0,50),search_type:t,results_count:s.count,load_time:s.loadTime,from_cache:s.fromCache})}static setUserContext(e){}static initialize(){}static setupPerformanceMonitoring(){}static setupErrorMonitoring(){}}},93423:(e,t,s)=>{"use strict";s.d(t,{z:()=>i});const n=s(22488),a=s(96800),r=s(24004);function i(e={}){const{user:t}=(0,a.a)(),{enableAutoTracking:s=!0,enablePerformanceTracking:i=!0,enableErrorTracking:c=!0}=e,o=(0,n.useCallback)((e,s={},n={})=>{r.vC.trackEvent(e,{...s,user_role:t?.role},n)},[t?.role]),l=(0,n.useCallback)((e,s,n={})=>{i&&r.vC.trackPerformance(e,s,{...n,user_role:t?.role||"anonymous"})},[i,t?.role]),d=(0,n.useCallback)((e,s={})=>{t&&r.vC.trackUserSession(t.uid,e,{...s,userRole:t.role})},[t]),u=(0,n.useCallback)((e,s,n={})=>{r.vC.trackLocationEvent(e,s,{...n,role:t?.role})},[t?.role]);return{trackEvent:o,trackPerformance:l,trackUserSession:d,trackLocationEvent:u,trackSearch:(0,n.useCallback)((e,t,s)=>{r.vC.trackSearch(e,t,s)},[]),trackError:(0,n.useCallback)((e,s={},n="medium")=>{c&&r.vC.trackError(e,{...s,user_role:t?.role,user_id:t?.uid},n)},[c,t?.role,t?.uid]),trackCachePerformance:(0,n.useCallback)((e,t={})=>{i&&r.vC.trackCachePerformance(e,t)},[i]),trackLogin:e=>o(r.dW.LOGIN,{method:e}),trackLogout:()=>o(r.dW.LOGOUT),trackCheckIn:e=>u("check_in",e),trackCheckOut:e=>u("check_out",e),trackCheckInDuration:e=>l(r.iB.CHECK_IN_DURATION,e),trackLocationLoadTime:e=>l(r.iB.LOCATION_LOAD_TIME,e),trackSessionListLoad:e=>l(r.iB.SESSION_LIST_LOAD,e),trackUserSearchTime:e=>l(r.iB.USER_SEARCH_TIME,e),trackCacheResponseTime:e=>l(r.iB.CACHE_RESPONSE_TIME,e)}}},96800:(e,t,s)=>{"use strict";s.d(t,{a:()=>a});const n=s(22488);function a(){const[e,t]=(0,n.useState)(null),[s,a]=(0,n.useState)(!0);return{user:e,loading:s}}s(94018),s(41662),s(66204)},42362:(e,t,s)=>{"use strict";s.d(t,{k:()=>r});const n=s(22488);const a={HIGH_DOWNLINK:5,MEDIUM_DOWNLINK:1.5,HIGH_RTT:50,MEDIUM_RTT:150,STABILITY_WINDOW:3e4};function r(){const[e,t]=(0,n.useState)(()=>({isOnline:navigator.onLine,isConnected:navigator.onLine,connectionType:"unknown",effectiveType:"unknown",downlink:0,rtt:0,saveData:!1,connectivityScore:navigator.onLine?50:0})),[s,r]=(0,n.useState)({online:new Set,offline:new Set,change:new Set}),[i,c]=(0,n.useState)([]),o=(0,n.useCallback)((e,t,s,n)=>{if(!e)return 0;let r=40;switch(t>=a.HIGH_DOWNLINK?r+=30:t>=a.MEDIUM_DOWNLINK?r+=20:t>0&&(r+=10),s<=a.HIGH_RTT?r+=20:s<=a.MEDIUM_RTT?r+=15:s>0&&(r+=5),n){case"4g":r+=10;break;case"3g":r+=7;break;case"2g":r+=3;break;case"slow-2g":r+=1}return Math.min(100,Math.max(0,r))},[]);(0,n.useCallback)(()=>{const e=window.navigator,s=e.connection||e.mozConnection||e.webkitConnection,n=e.onLine,r=s?.type||"unknown",i=s?.effectiveType||"unknown",l=s?.downlink||0,d=s?.rtt||0,u=s?.saveData||!1,m=o(n,l,d,i),h={isOnline:n,isConnected:n&&m>20,connectionType:r,effectiveType:i,downlink:l,rtt:d,saveData:u,connectivityScore:m};t(e=>{const t=Date.now(),s={...h};return n&&!e.isOnline?s.lastOnlineAt=t:!n&&e.isOnline?s.lastOfflineAt=t:(s.lastOnlineAt=e.lastOnlineAt,s.lastOfflineAt=e.lastOfflineAt),s}),c(e=>{const t=Date.now(),s=t-a.STABILITY_WINDOW;return[...e.filter(e=>e.timestamp>s),{timestamp:t,isOnline:n}]})},[o]);const l=(0,n.useCallback)(async()=>{try{const e=Date.now(),s=await fetch("/api/health",{method:"HEAD",cache:"no-cache",signal:AbortSignal.timeout(5e3)}),n=Date.now(),a=s.ok,r=n-e;return t(e=>({...e,isConnected:a,rtt:Math.min(e.rtt||1/0,r),connectivityScore:o(a,e.downlink,r,e.effectiveType)})),a}catch(e){return t(e=>({...e,isConnected:!1,connectivityScore:0})),!1}},[o]),d=(0,n.useCallback)(async()=>{try{const e=performance.now();await fetch("/api/health",{method:"HEAD",cache:"no-cache",signal:AbortSignal.timeout(3e3)});const t=performance.now();return Math.round(t-e)}catch(e){return -1}},[]),u=(0,n.useCallback)(e=>(r(t=>{const s=new Set(t.online);return s.add(e),{...t,online:s}}),()=>{r(t=>{const s=new Set(t.online);return s.delete(e),{...t,online:s}})}),[]),m=(0,n.useCallback)(e=>(r(t=>{const s=new Set(t.offline);return s.add(e),{...t,offline:s}}),()=>{r(t=>{const s=new Set(t.offline);return s.delete(e),{...t,offline:s}})}),[]),h=(0,n.useCallback)(e=>(r(t=>{const s=new Set(t.change);return s.add(e),{...t,change:s}}),()=>{r(t=>{const s=new Set(t.change);return s.delete(e),{...t,change:s}})}),[]),y=e.connectivityScore>=80,f=e.connectivityScore>=50&&e.connectivityScore<80,g=e.connectivityScore>=20&&e.connectivityScore<50,p=i.length>=3&&i.slice(-3).every(t=>t.isOnline===e.isOnline),x=!p&&i.length>=2,S=e.isConnected&&e.connectivityScore>=30&&p,w=e.isOnline&&(e.connectivityScore<30||x);return{...e,isHighQuality:y,isMediumQuality:f,isLowQuality:g,isStable:p,isUnstable:x,shouldSync:S,shouldDelaySync:w,onOnline:u,onOffline:m,onConnectionChange:h,checkConnectivity:l,ping:d}}},71641:(e,t,s)=>{"use strict";s.d(t,{AnalyticsProvider:()=>N});const n=s(28002),a=s(22488),r=s(93423);s(24004),s(65677);const i={LCP:{good:2500,needsImprovement:4e3},INP:{good:200,needsImprovement:500},CLS:{good:.1,needsImprovement:.25},FCP:{good:1800,needsImprovement:3e3},TTFB:{good:800,needsImprovement:1800}},c={};const o=s(16885),l=s(78620),d=s(34687),u=s(23968),m=s(28372),h=s(26992),y=s(55911),f=s(98979),g=s(56197),p=s(8991),x=s(13765),S=s(42974),w=s(17570);function v({showDetails:e=!0,autoRefresh:t=!0,refreshInterval:s=5e3}){const[r,v]=(0,a.useState)([]),[N,b]=(0,a.useState)(!1),[j,A]=(0,a.useState)(null),C=(0,a.useCallback)(()=>{v(c.getCurrentMetrics()),A(new Date)},[]),k=e=>{switch(e){case"LCP":return n.jsx(m.Z,{className:"w-4 h-4"});case"FID":return n.jsx(h.Z,{className:"w-4 h-4"});case"CLS":default:return n.jsx(y.Z,{className:"w-4 h-4"});case"FCP":return n.jsx(f.Z,{className:"w-4 h-4"});case"TTFB":return n.jsx(g.Z,{className:"w-4 h-4"})}},I=e=>{switch(e){case"good":return"default";case"needs-improvement":return"secondary";case"poor":return"destructive";default:return"outline"}},O=e=>{switch(e){case"good":return"text-green-600";case"needs-improvement":return"text-yellow-600";case"poor":return"text-red-600";default:return"text-gray-600"}},E=()=>c.getPerformanceGrade(),T=(e,t)=>{const s=i[e];if(!s)return 100;const n=1.5*s.needsImprovement;return Math.max(0,Math.min(100,(n-t)/n*100))};return N?n.jsx("div",{className:"fixed bottom-4 right-4 z-50 w-96",children:(0,n.jsxs)(o.Zb,{className:"w-full",children:[(0,n.jsxs)(o.Ol,{className:"pb-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)(o.ll,{className:"flex items-center text-lg",children:[n.jsx(y.Z,{className:"w-5 h-5 mr-2"}),"Performance Monitor"]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsxs)(l.C,{variant:"outline",className:"font-mono",children:["Grade: ",E()]}),n.jsx(d.z,{variant:"ghost",size:"sm",onClick:C,disabled:!r.length,children:n.jsx(p.Z,{className:"w-4 h-4"})}),n.jsx(d.z,{variant:"ghost",size:"sm",onClick:()=>b(!1),children:"✕"})]})]}),(0,n.jsxs)(o.SZ,{children:["Core Web Vitals monitoring",j&&(0,n.jsxs)("span",{className:"block text-xs mt-1",children:["Last updated: ",j.toLocaleTimeString()]})]})]}),n.jsx(o.aY,{className:"space-y-4",children:0===r.length?(0,n.jsxs)("div",{className:"flex items-center justify-center py-8 text-muted-foreground",children:[n.jsx(y.Z,{className:"w-6 h-6 mr-2 animate-pulse"}),"Collecting metrics..."]}):(0,n.jsxs)(n.Fragment,{children:[n.jsx("div",{className:"grid grid-cols-1 gap-3",children:r.map(t=>(0,n.jsxs)("div",{className:"flex items-center space-x-3 p-3 border rounded-lg",children:[n.jsx("div",{className:`p-2 rounded-full bg-gray-100 ${O(t.rating)}`,children:k(t.name)}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[n.jsx("p",{className:"font-medium",children:t.name}),n.jsx(l.C,{variant:I(t.rating),children:t.rating.replace("-"," ")})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[n.jsx("span",{className:"text-2xl font-bold",children:"CLS"===t.name?t.value.toFixed(3):Math.round(t.value)}),n.jsx("span",{className:"text-sm text-muted-foreground",children:"CLS"===t.name?"score":"ms"})]}),e&&n.jsx(u.E,{value:T(t.name,t.value),className:"mt-2 h-2"})]})]},t.name))}),e&&(0,n.jsxs)("div",{className:"border-t pt-4 space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"font-medium",children:"Performance Summary"}),(0,n.jsxs)(d.z,{variant:"ghost",size:"sm",onClick:()=>{const e=new Blob([JSON.stringify({timestamp:new Date().toISOString(),grade:E(),metrics:r,url:window.location.href,userAgent:navigator.userAgent,viewport:{width:window.innerWidth,height:window.innerHeight}},null,2)],{type:"application/json"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download=`web-vitals-${Date.now()}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)},children:[n.jsx(x.Z,{className:"w-4 h-4 mr-2"}),"Export"]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[n.jsx("p",{className:"text-muted-foreground",children:"Overall Grade"}),n.jsx("p",{className:"font-mono text-lg",children:E()})]}),(0,n.jsxs)("div",{className:"space-y-1",children:[n.jsx("p",{className:"text-muted-foreground",children:"Metrics Count"}),n.jsx("p",{className:"font-mono text-lg",children:r.length})]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-1",children:[n.jsx(S.Z,{className:"w-3 h-3 text-green-600"}),n.jsx("span",{children:"Good"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-1",children:[n.jsx(w.Z,{className:"w-3 h-3 text-yellow-600"}),n.jsx("span",{children:"Needs Improvement"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-1",children:[n.jsx(w.Z,{className:"w-3 h-3 text-red-600"}),n.jsx("span",{children:"Poor"})]})]})]})]})})]})}):(0,n.jsxs)(d.z,{variant:"outline",size:"sm",onClick:()=>b(!0),className:"fixed bottom-4 right-4 z-50",children:[n.jsx(y.Z,{className:"w-4 h-4 mr-2"}),"Performance"]})}function N({children:e,showPerformanceMonitor:t=!1}){return(0,r.z)(),(0,n.jsxs)(n.Fragment,{children:[e,t&&n.jsx(v,{showDetails:!1,autoRefresh:!0,refreshInterval:5e3})]})}},73521:(e,t,s)=>{"use strict";s.d(t,{cn:()=>r});const n=s(65116),a=s(99576);function r(...e){return(0,a.m6)((0,n.W)(e))}},67641:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=(0,s(17369).createProxy)(String.raw`/Users/arthurturnbull/Developer/schools-in/src/app/error.tsx#default`)},5023:()=>{}};
//# sourceMappingURL=750.js.map